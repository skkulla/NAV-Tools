OBJECT Table 4 Currency
{
  OBJECT-PROPERTIES
  {
    Date=11/07/11;
    Time=10:41:56 AM;
    Modified=Yes;
    Version List=NAVW16.00,NAVNA5.00;
  }
  PROPERTIES
  {
    OnModify=BEGIN
               "Last Date Modified" := TODAY;
             END;

    OnDelete=BEGIN
               CurrExchRate.SETRANGE("Currency Code",Code);
               CurrExchRate.DELETEALL;
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
             END;

    CaptionML=[ENU=Currency;
               ESM=Divisa;
               FRC=Devise;
               ENC=Currency];
    LookupFormID=Form5;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              ESM=C¢digo;
                                                              FRC="Code  ";
                                                              ENC=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              ESM=Fecha £lt. modificaci¢n;
                                                              FRC=Date derniäre modification;
                                                              ENC=Last Date Modified];
                                                   Editable=No }
    { 3   ;   ;Last Date Adjusted  ;Date          ;CaptionML=[ENU=Last Date Adjusted;
                                                              ESM=Fecha £lt. ajuste divisas;
                                                              FRC=Date dernier ajustement;
                                                              ENC=Last Date Adjusted];
                                                   Editable=No }
    { 6   ;   ;Unrealized Gains Acc.;Code20       ;TableRelation="G/L Account";
                                                   OnValidate=BEGIN
                                                                CheckGLAcc("Unrealized Gains Acc.");
                                                              END;

                                                   CaptionML=[ENU=Unrealized Gains Acc.;
                                                              ESM=Cta. dif. pos. no realizadas;
                                                              FRC=Compte gains non rÇalisÇs;
                                                              ENC=Unrealized Gains Acc.] }
    { 7   ;   ;Realized Gains Acc. ;Code20        ;TableRelation="G/L Account";
                                                   OnValidate=BEGIN
                                                                CheckGLAcc("Realized Gains Acc.");
                                                              END;

                                                   CaptionML=[ENU=Realized Gains Acc.;
                                                              ESM=Cta. dif. pos. realizadas;
                                                              FRC=Compte gains rÇalisÇs;
                                                              ENC=Realized Gains Acc.] }
    { 8   ;   ;Unrealized Losses Acc.;Code20      ;TableRelation="G/L Account";
                                                   OnValidate=BEGIN
                                                                CheckGLAcc("Unrealized Losses Acc.");
                                                              END;

                                                   CaptionML=[ENU=Unrealized Losses Acc.;
                                                              ESM=Cta. dif. neg. no realizadas;
                                                              FRC=Compte pertes non rÇalisÇes;
                                                              ENC=Unrealized Losses Acc.] }
    { 9   ;   ;Realized Losses Acc.;Code20        ;TableRelation="G/L Account";
                                                   OnValidate=BEGIN
                                                                CheckGLAcc("Realized Losses Acc.");
                                                              END;

                                                   CaptionML=[ENU=Realized Losses Acc.;
                                                              ESM=Cta. dif. neg. realizadas;
                                                              FRC=Compte pertes rÇalisÇes;
                                                              ENC=Realized Losses Acc.] }
    { 10  ;   ;Invoice Rounding Precision;Decimal ;InitValue=1;
                                                   OnValidate=BEGIN
                                                                IF "Amount Rounding Precision" <> 0 THEN
                                                                  IF "Invoice Rounding Precision" <> ROUND("Invoice Rounding Precision","Amount Rounding Precision") THEN
                                                                    FIELDERROR(
                                                                      "Invoice Rounding Precision",
                                                                      STRSUBSTNO(Text000,"Amount Rounding Precision"));
                                                              END;

                                                   CaptionML=[ENU=Invoice Rounding Precision;
                                                              ESM=Precisi¢n redondeo factura;
                                                              FRC=PrÇc. arrondis. facture;
                                                              ENC=Invoice Rounding Precision];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 12  ;   ;Invoice Rounding Type;Option       ;CaptionML=[ENU=Invoice Rounding Type;
                                                              ESM=Tipo redondeo factura;
                                                              FRC=Type arrondis. facture;
                                                              ENC=Invoice Rounding Type];
                                                   OptionCaptionML=[ENU=Nearest,Up,Down;
                                                                    ESM=M†s cercano,Superior,Inferior;
                                                                    FRC=Plus präs,Haut,Bas;
                                                                    ENC=Nearest,Up,Down];
                                                   OptionString=Nearest,Up,Down }
    { 13  ;   ;Amount Rounding Precision;Decimal  ;InitValue=0.01;
                                                   OnValidate=BEGIN
                                                                IF "Amount Rounding Precision" <> 0 THEN
                                                                  "Invoice Rounding Precision" := ROUND("Invoice Rounding Precision","Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Amount Rounding Precision;
                                                              ESM=Prec. redondeo importe;
                                                              FRC=PrÇcision arrondis. montant;
                                                              ENC=Amount Rounding Precision];
                                                   DecimalPlaces=2:5;
                                                   MinValue=0 }
    { 14  ;   ;Unit-Amount Rounding Precision;Decimal;
                                                   InitValue=0.00001;
                                                   CaptionML=[ENU=Unit-Amount Rounding Precision;
                                                              ESM=Prec. redondeo precio-prod.;
                                                              FRC=PrÇcis. arrondi. montant unit.;
                                                              ENC=Unit-Amount Rounding Precision];
                                                   DecimalPlaces=0:9;
                                                   MinValue=0 }
    { 15  ;   ;Description         ;Text30        ;CaptionML=[ENU=Description;
                                                              ESM=Descripci¢n;
                                                              FRC=Description;
                                                              ENC=Description] }
    { 17  ;   ;Amount Decimal Places;Text5        ;InitValue=2:2;
                                                   OnValidate=BEGIN
                                                                GLSetup.CheckDecimalPlacesFormat("Amount Decimal Places");
                                                              END;

                                                   CaptionML=[ENU=Amount Decimal Places;
                                                              ESM=Nß decimales para importes;
                                                              FRC=Nombre dÇcimales montant;
                                                              ENC=Amount Decimal Places];
                                                   NotBlank=Yes }
    { 18  ;   ;Unit-Amount Decimal Places;Text5   ;InitValue=2:5;
                                                   OnValidate=BEGIN
                                                                GLSetup.CheckDecimalPlacesFormat("Unit-Amount Decimal Places");
                                                              END;

                                                   CaptionML=[ENU=Unit-Amount Decimal Places;
                                                              ESM=Nß decimales para precio-prod.;
                                                              FRC=Nombre dÇcimales montant unit.;
                                                              ENC=Unit-Amount Decimal Places];
                                                   NotBlank=Yes }
    { 19  ;   ;Customer Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Customer;
                                                   CaptionML=[ENU=Customer Filter;
                                                              ESM=Filtro cliente;
                                                              FRC=Filtre client;
                                                              ENC=Customer Filter] }
    { 20  ;   ;Vendor Filter       ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Vendor;
                                                   CaptionML=[ENU=Vendor Filter;
                                                              ESM=Filtro proveedor;
                                                              FRC=Filtre fournisseur;
                                                              ENC=Vendor Filter] }
    { 21  ;   ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   CaptionML=[ENU=Global Dimension 1 Filter;
                                                              ESM=Filtro dimensi¢n global 1;
                                                              FRC=Filtre dimension principale 1;
                                                              ENC=Global Dimension 1 Filter];
                                                   CaptionClass='1,3,1' }
    { 22  ;   ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   CaptionML=[ENU=Global Dimension 2 Filter;
                                                              ESM=Filtro dimensi¢n global  2;
                                                              FRC=Filtre dimension principale 2;
                                                              ENC=Global Dimension 2 Filter];
                                                   CaptionClass='1,3,2' }
    { 23  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              ESM=Filtro fecha;
                                                              FRC=Filtre date;
                                                              ENC=Date Filter] }
    { 24  ;   ;Cust. Ledg. Entries in Filter;Boolean;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Exist("Cust. Ledger Entry" WHERE (Customer No.=FIELD(Customer Filter),
                                                                                                 Currency Code=FIELD(Code)));
                                                   CaptionML=[ENU=Cust. Ledg. Entries in Filter;
                                                              ESM=Movs. cliente en filtro;
                                                              FRC=êcritures clients dans filtre;
                                                              ENC=Cust. Ledg. Entries in Filter];
                                                   Editable=No }
    { 25  ;   ;Customer Balance    ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Customer No.=FIELD(Customer Filter),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Posting Date=FIELD(Date Filter),
                                                                                                              Currency Code=FIELD(Code)));
                                                   CaptionML=[ENU=Customer Balance;
                                                              ESM=Saldo cliente;
                                                              FRC=Solde client;
                                                              ENC=Customer Balance];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 26  ;   ;Customer Outstanding Orders;Decimal;FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Outstanding Amount" WHERE (Document Type=CONST(Order),
                                                                                                            Bill-to Customer No.=FIELD(Customer Filter),
                                                                                                            Currency Code=FIELD(Code),
                                                                                                            Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                            Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter)));
                                                   CaptionML=[ENU=Customer Outstanding Orders;
                                                              ESM=Pedidos pendientes cliente;
                                                              FRC=Commandes ouvertes client;
                                                              ENC=Customer Outstanding Orders];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 27  ;   ;Customer Shipped Not Invoiced;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Sales Line"."Shipped Not Invoiced" WHERE (Document Type=CONST(Order),
                                                                                                              Bill-to Customer No.=FIELD(Customer Filter),
                                                                                                              Currency Code=FIELD(Code),
                                                                                                              Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                              Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter)));
                                                   CaptionML=[ENU=Customer Shipped Not Invoiced;
                                                              ESM=Enviado a cliente no factur.;
                                                              FRC=LivrÇ non facturÇ client;
                                                              ENC=Customer Shipped Not Invoiced];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 28  ;   ;Customer Balance Due;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry".Amount WHERE (Customer No.=FIELD(Customer Filter),
                                                                                                              Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                              Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                              Initial Entry Due Date=FIELD(Date Filter),
                                                                                                              Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                              Currency Code=FIELD(Code)));
                                                   CaptionML=[ENU=Customer Balance Due;
                                                              ESM=Saldo vencido cliente;
                                                              FRC=Solde dñ client;
                                                              ENC=Customer Balance Due];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 29  ;   ;Vendor Ledg. Entries in Filter;Boolean;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Exist("Vendor Ledger Entry" WHERE (Vendor No.=FIELD(Vendor Filter),
                                                                                                  Currency Code=FIELD(Code)));
                                                   CaptionML=[ENU=Vendor Ledg. Entries in Filter;
                                                              ESM=Movs. proveedor en filtro;
                                                              FRC=êcritures fourn. dans filtre;
                                                              ENC=Vendor Ledg. Entries in Filter];
                                                   Editable=No }
    { 30  ;   ;Vendor Balance      ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(Vendor Filter),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Posting Date=FIELD(Date Filter),
                                                                                                                Currency Code=FIELD(Code)));
                                                   CaptionML=[ENU=Vendor Balance;
                                                              ESM=Saldo proveedor;
                                                              FRC=Solde fournisseur;
                                                              ENC=Vendor Balance];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 31  ;   ;Vendor Outstanding Orders;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Outstanding Amount" WHERE (Document Type=CONST(Order),
                                                                                                               Pay-to Vendor No.=FIELD(Vendor Filter),
                                                                                                               Currency Code=FIELD(Code),
                                                                                                               Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                               Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter)));
                                                   CaptionML=[ENU=Vendor Outstanding Orders;
                                                              ESM=Pedidos pendientes proveedor;
                                                              FRC=Commandes ouvertes fournisseur;
                                                              ENC=Vendor Outstanding Orders];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 32  ;   ;Vendor Amt. Rcd. Not Invoiced;Decimal;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Amt. Rcd. Not Invoiced" WHERE (Document Type=CONST(Order),
                                                                                                                   Pay-to Vendor No.=FIELD(Vendor Filter),
                                                                                                                   Currency Code=FIELD(Code),
                                                                                                                   Shortcut Dimension 1 Code=FIELD(Global Dimension 1 Filter),
                                                                                                                   Shortcut Dimension 2 Code=FIELD(Global Dimension 2 Filter)));
                                                   CaptionML=[ENU=Vendor Amt. Rcd. Not Invoiced;
                                                              ESM=Recibido de prov. no facturado;
                                                              FRC=Montant reáu non fact. fourn.;
                                                              ENC=Vendor Amt. Rcd. Not Invoiced];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 33  ;   ;Vendor Balance Due  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry".Amount WHERE (Vendor No.=FIELD(Vendor Filter),
                                                                                                                Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                Initial Entry Due Date=FIELD(Date Filter),
                                                                                                                Posting Date=FIELD(UPPERLIMIT(Date Filter)),
                                                                                                                Currency Code=FIELD(Code)));
                                                   CaptionML=[ENU=Vendor Balance Due;
                                                              ESM=Saldo vencido proveedor;
                                                              FRC=Solde dñ fournisseur;
                                                              ENC=Vendor Balance Due];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 34  ;   ;Customer Balance (LCY);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Customer No.=FIELD(Customer Filter),
                                                                                                                      Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Posting Date=FIELD(Date Filter),
                                                                                                                      Currency Code=FIELD(Code)));
                                                   CaptionML=[ENU=Customer Balance ($);
                                                              ESM=Saldo cliente ($);
                                                              FRC=Solde client ($);
                                                              ENC=Customer Balance ($)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 35  ;   ;Vendor Balance (LCY);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Vendor No.=FIELD(Vendor Filter),
                                                                                                                        Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Posting Date=FIELD(Date Filter),
                                                                                                                        Currency Code=FIELD(Code)));
                                                   CaptionML=[ENU=Vendor Balance ($);
                                                              ESM=Saldo proveedor ($);
                                                              FRC=Solde fournisseur ($);
                                                              ENC=Vendor Balance ($)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 40  ;   ;Realized G/L Gains Account;Code20  ;TableRelation="G/L Account";
                                                   OnValidate=BEGIN
                                                                CheckGLAcc("Realized G/L Gains Account");
                                                              END;

                                                   CaptionML=[ENU=Realized G/L Gains Account;
                                                              ESM=Cta. aj. pos. C/G realizados;
                                                              FRC=Compte GL gains rÇalisÇs;
                                                              ENC=Realized G/L Gains Account] }
    { 41  ;   ;Realized G/L Losses Account;Code20 ;TableRelation="G/L Account";
                                                   OnValidate=BEGIN
                                                                CheckGLAcc("Realized G/L Losses Account");
                                                              END;

                                                   CaptionML=[ENU=Realized G/L Losses Account;
                                                              ESM=Cta. aj. neg. C/G realizados;
                                                              FRC=Compte GL pertes rÇalisÇes;
                                                              ENC=Realized G/L Losses Account] }
    { 44  ;   ;Appln. Rounding Precision;Decimal  ;CaptionML=[ENU=Appln. Rounding Precision;
                                                              ESM=Precisi¢n redondeo liquidaci¢n;
                                                              FRC=Arrondissement effectuÇ;
                                                              ENC=Appln. Rounding Precision];
                                                   MinValue=0;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 45  ;   ;EMU Currency        ;Boolean       ;CaptionML=[ENU=EMU Currency;
                                                              ESM=Divisa UME;
                                                              FRC=Devise U.M.E.;
                                                              ENC=EMU Currency] }
    { 46  ;   ;Currency Factor     ;Decimal       ;CaptionML=[ENU=Currency Factor;
                                                              ESM=Factor divisa;
                                                              FRC=Facteur devise;
                                                              ENC=Currency Factor];
                                                   DecimalPlaces=0:5;
                                                   Editable=No }
    { 47  ;   ;Residual Gains Account;Code20      ;TableRelation="G/L Account";
                                                   CaptionML=[ENU=Residual Gains Account;
                                                              ESM=Cta. aj. residual pos.;
                                                              FRC=Compte de gains rÇsiduels;
                                                              ENC=Residual Gains Account] }
    { 48  ;   ;Residual Losses Account;Code20     ;TableRelation="G/L Account";
                                                   CaptionML=[ENU=Residual Losses Account;
                                                              ESM=Cta. aj. residual neg.;
                                                              FRC=Compte de pertes rÇsiduelles;
                                                              ENC=Residual Losses Account] }
    { 50  ;   ;Conv. LCY Rndg. Debit Acc.;Code20  ;TableRelation="G/L Account";
                                                   CaptionML=[ENU=Conv. $ Rndg. Debit Acc.;
                                                              ESM=Cta. residual neg. conv. en $;
                                                              FRC=Compte dÇbit arrondi $;
                                                              ENC=Conv. $ Rndg. Debit Acc.] }
    { 51  ;   ;Conv. LCY Rndg. Credit Acc.;Code20 ;TableRelation="G/L Account";
                                                   CaptionML=[ENU=Conv. $ Rndg. Credit Acc.;
                                                              ESM=Cta. residual pos. conv. en $;
                                                              FRC=Compte crÇdit arrondi $;
                                                              ENC=Conv. $ Rndg. Credit Acc.] }
    { 52  ;   ;Max. VAT Difference Allowed;Decimal;OnValidate=BEGIN
                                                                IF "Max. VAT Difference Allowed" <> ROUND("Max. VAT Difference Allowed","Amount Rounding Precision") THEN
                                                                  ERROR(
                                                                    Text001,
                                                                    FIELDCAPTION("Max. VAT Difference Allowed"),"Amount Rounding Precision");

                                                                "Max. VAT Difference Allowed" := ABS("Max. VAT Difference Allowed");
                                                              END;

                                                   CaptionML=[ENU=Max. Tax Difference Allowed;
                                                              ESM=M†x. diferencia IVA permitida;
                                                              FRC=DiffÇrence TVA max. autorisÇe;
                                                              ENC=Max. Tax Difference Allowed];
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 53  ;   ;VAT Rounding Type   ;Option        ;CaptionML=[ENU=Tax Rounding Type;
                                                              ESM=Tipo redondeo IVA;
                                                              FRC=Type arrondi TVA;
                                                              ENC=Tax Rounding Type];
                                                   OptionCaptionML=[ENU=Nearest,Up,Down;
                                                                    ESM=M†s cercano,Superior,Inferior;
                                                                    FRC=Plus präs,Haut,Bas;
                                                                    ENC=Nearest,Up,Down];
                                                   OptionString=Nearest,Up,Down }
    { 54  ;   ;Payment Tolerance % ;Decimal       ;CaptionML=[ENU=Payment Tolerance %;
                                                              ESM=% Tolerancia pago;
                                                              FRC=% Çcart de räglement;
                                                              ENC=Payment Tolerance %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   Editable=No }
    { 55  ;   ;Max. Payment Tolerance Amount;Decimal;
                                                   CaptionML=[ENU=Max. Payment Tolerance Amount;
                                                              ESM=M†x. importe tolerancia pago;
                                                              FRC=Montant Çcart räglement max.;
                                                              ENC=Max. Payment Tolerance Amount];
                                                   MinValue=0;
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr=Code }
    { 10000;  ;Symbol              ;Code5         ;CaptionML=[ENU=Symbol;
                                                              ESM=S°mbolo;
                                                              FRC=Symbole;
                                                              ENC=Symbol] }
    { 50001;  ;Update Exchange Rate;Boolean        }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=must be rounded to the nearest %1;ESM=se debe redondear al %1 m†s cercano;FRC=doit àtre arrondi au %1 le plus präs;ENC=must be rounded to the nearest %1';
      Text001@1001 : TextConst 'ENU=%1 must be rounded to the nearest %2.;ESM=Se debe redondear %1 al m†s cercano %2.;FRC=%1 doit àtre arrondi au plus präs de %2.;ENC=%1 must be rounded to the nearest %2.';
      CurrExchRate@1002 : Record 330;
      GLSetup@1003 : Record 98;

    PROCEDURE InitRoundingPrecision@2();
    BEGIN
      GLSetup.GET;
      IF GLSetup."Amount Rounding Precision" <> 0 THEN
        "Amount Rounding Precision" := GLSetup."Amount Rounding Precision"
      ELSE
        "Amount Rounding Precision" := 0.01;
      IF GLSetup."Unit-Amount Rounding Precision" <> 0 THEN
        "Unit-Amount Rounding Precision" := GLSetup."Unit-Amount Rounding Precision"
      ELSE
        "Unit-Amount Rounding Precision" := 0.00001;
      "Max. VAT Difference Allowed" := GLSetup."Max. VAT Difference Allowed";
      "VAT Rounding Type" := GLSetup."VAT Rounding Type";
      "Invoice Rounding Precision" := GLSetup."Inv. Rounding Precision (LCY)";
      "Invoice Rounding Type" := GLSetup."Inv. Rounding Type (LCY)";
      Symbol := '$';
    END;

    LOCAL PROCEDURE CheckGLAcc@1(AccNo@1000 : Code[20]);
    VAR
      GLAcc@1001 : Record 15;
    BEGIN
      IF AccNo <> '' THEN BEGIN
        GLAcc.GET(AccNo);
        GLAcc.CheckGLAcc;
      END;
    END;

    PROCEDURE VATRoundingDirection@3() : Text[1];
    BEGIN
      CASE "VAT Rounding Type" OF
        "VAT Rounding Type"::Nearest:
          EXIT('=');
        "VAT Rounding Type"::Up:
          EXIT('>');
        "VAT Rounding Type"::Down:
          EXIT('<');
      END;
    END;

    PROCEDURE InvoiceRoundingDirection@4() : Text[1];
    BEGIN
      CASE "Invoice Rounding Type" OF
        "Invoice Rounding Type"::Nearest:
          EXIT('=');
        "Invoice Rounding Type"::Up:
          EXIT('>');
        "Invoice Rounding Type"::Down:
          EXIT('<');
      END;
    END;

    PROCEDURE CheckAmountRoundingPrecision@5();
    BEGIN
      TESTFIELD("Unit-Amount Rounding Precision");
      TESTFIELD("Amount Rounding Precision");
    END;

    BEGIN
    {
      WMI0001 SK  11/07/11: Added new field "Update Exchange Rate".
    }
    END.
  }
}

OBJECT Table 98 General Ledger Setup
{
  OBJECT-PROPERTIES
  {
    Date=11/07/11;
    Time=11:03:41 AM;
    Modified=Yes;
    Version List=NAVW16.00,NAVNA5.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=General Ledger Setup;
               ESM=Configuraci¢n contabilidad;
               FRC=Configuration du grand livre;
               ENC=General Ledger Setup];
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              ESM=Clave primaria;
                                                              FRC=ClÇ primaire;
                                                              ENC=Primary Key] }
    { 2   ;   ;Allow Posting From  ;Date          ;CaptionML=[ENU=Allow Posting From;
                                                              ESM=Permitir registro desde;
                                                              FRC=DÇbut pÇriode report;
                                                              ENC=Allow Posting From] }
    { 3   ;   ;Allow Posting To    ;Date          ;CaptionML=[ENU=Allow Posting To;
                                                              ESM=Permitir registro hasta;
                                                              FRC=Fin pÇriode report;
                                                              ENC=Allow Posting To] }
    { 4   ;   ;Register Time       ;Boolean       ;CaptionML=[ENU=Register Time;
                                                              ESM=Registrar tiempo conexi¢n;
                                                              FRC=Registre temps;
                                                              ENC=Register Time] }
    { 28  ;   ;Pmt. Disc. Excl. VAT;Boolean       ;OnValidate=BEGIN
                                                                IF "Pmt. Disc. Excl. VAT" THEN
                                                                  TESTFIELD("Adjust for Payment Disc.",FALSE)
                                                                ELSE
                                                                  TESTFIELD("VAT Tolerance %",0);
                                                              END;

                                                   CaptionML=[ENU=Pmt. Disc. Excl. Tax;
                                                              ESM=Dto. P.P. sin IVA;
                                                              FRC=Escompte sans taxe;
                                                              ENC=Pmt. Disc. Excl. Tax] }
    { 41  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              ESM=Filtro fecha;
                                                              FRC=Filtre date;
                                                              ENC=Date Filter] }
    { 42  ;   ;Global Dimension 1 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Dimension Code=FIELD(Global Dimension 1 Code));
                                                   CaptionML=[ENU=Global Dimension 1 Filter;
                                                              ESM=Filtro dimensi¢n global 1;
                                                              FRC=Filtre dimension principale 1;
                                                              ENC=Global Dimension 1 Filter];
                                                   CaptionClass='1,3,1' }
    { 43  ;   ;Global Dimension 2 Filter;Code20   ;FieldClass=FlowFilter;
                                                   TableRelation="Dimension Value".Code WHERE (Dimension Code=FIELD(Global Dimension 2 Code));
                                                   CaptionML=[ENU=Global Dimension 2 Filter;
                                                              ESM=Filtro dimensi¢n global  2;
                                                              FRC=Filtre dimension principale 2;
                                                              ENC=Global Dimension 2 Filter];
                                                   CaptionClass='1,3,2' }
    { 44  ;   ;Cust. Balances Due  ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Detailed Cust. Ledg. Entry"."Amount (LCY)" WHERE (Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                      Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                      Initial Entry Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Cust. Balances Due;
                                                              ESM=Saldo pdte. clientes;
                                                              FRC=Soldes dus client;
                                                              ENC=Cust. Balances Due];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 45  ;   ;Vendor Balances Due ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=-Sum("Detailed Vendor Ledg. Entry"."Amount (LCY)" WHERE (Initial Entry Global Dim. 1=FIELD(Global Dimension 1 Filter),
                                                                                                                        Initial Entry Global Dim. 2=FIELD(Global Dimension 2 Filter),
                                                                                                                        Initial Entry Due Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Vendor Balances Due;
                                                              ESM=Saldo pdte. proveedores;
                                                              FRC=Soldes dus fournisseur;
                                                              ENC=Vendor Balances Due];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 48  ;   ;Unrealized VAT      ;Boolean       ;OnValidate=BEGIN
                                                                IF NOT "Unrealized VAT" THEN BEGIN
                                                                  VATPostingSetup.SETFILTER(
                                                                    "Unrealized VAT Type",'>=%1',VATPostingSetup."Unrealized VAT Type"::Percentage);
                                                                  IF VATPostingSetup.FIND('-') THEN
                                                                    ERROR(
                                                                      Text000,VATPostingSetup.TABLECAPTION,
                                                                      VATPostingSetup."VAT Bus. Posting Group",VATPostingSetup."VAT Prod. Posting Group",
                                                                      VATPostingSetup.FIELDCAPTION("Unrealized VAT Type"),VATPostingSetup."Unrealized VAT Type");
                                                                  TaxJurisdiction.SETFILTER(
                                                                    "Unrealized VAT Type",'>=%1',TaxJurisdiction."Unrealized VAT Type"::Percentage);
                                                                  IF TaxJurisdiction.FIND('-') THEN
                                                                    ERROR(
                                                                      Text001,TaxJurisdiction.TABLECAPTION,
                                                                      TaxJurisdiction.Code,TaxJurisdiction.FIELDCAPTION("Unrealized VAT Type"),
                                                                      TaxJurisdiction."Unrealized VAT Type");
                                                                END;
                                                                IF "Unrealized VAT" THEN
                                                                  "Prepayment Unrealized VAT" := TRUE
                                                                ELSE
                                                                  "Prepayment Unrealized VAT" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=Unrealized Tax;
                                                              ESM=IVA no realizado;
                                                              FRC=Taxe non rÇalisÇe;
                                                              ENC=Unrealized Tax] }
    { 49  ;   ;Adjust for Payment Disc.;Boolean   ;OnValidate=BEGIN
                                                                IF "Adjust for Payment Disc." THEN BEGIN
                                                                  TESTFIELD("Pmt. Disc. Excl. VAT",FALSE);
                                                                  TESTFIELD("VAT Tolerance %",0);
                                                                END ELSE BEGIN
                                                                  VATPostingSetup.SETRANGE("Adjust for Payment Discount",TRUE);
                                                                  IF VATPostingSetup.FIND('-') THEN
                                                                    ERROR(
                                                                      Text002,VATPostingSetup.TABLECAPTION,
                                                                      VATPostingSetup."VAT Bus. Posting Group",VATPostingSetup."VAT Prod. Posting Group",
                                                                      VATPostingSetup.FIELDCAPTION("Adjust for Payment Discount"));
                                                                  TaxJurisdiction.SETRANGE("Adjust for Payment Discount",TRUE);
                                                                  IF TaxJurisdiction.FIND('-') THEN
                                                                    ERROR(
                                                                      Text003,TaxJurisdiction.TABLECAPTION,
                                                                      TaxJurisdiction.Code,TaxJurisdiction.FIELDCAPTION("Adjust for Payment Discount"));
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Adjust for Payment Disc.;
                                                              ESM=Ajuste para dto. P.P.;
                                                              FRC=Ajust. pour esc. paiement;
                                                              ENC=Adjust for Payment Disc.] }
    { 56  ;   ;Mark Cr. Memos as Corrections;Boolean;
                                                   CaptionML=[ENU=Mark Cr. Memos as Corrections;
                                                              ESM=Marcar nota crÇdito como correcci¢n;
                                                              FRC=Marquer note cr. comme corr.;
                                                              ENC=Mark Cr. Memos as Corrections] }
    { 57  ;   ;Local Address Format;Option        ;CaptionML=[ENU=Local Address Format;
                                                              ESM=Formato direcci¢n est†ndar;
                                                              FRC=Format local d'adresse;
                                                              ENC=Local Address Format];
                                                   OptionCaptionML=[ENU=ZIP Code+City,City+ZIP Code,City+State+ZIP Code,Blank Line+ZIP Code+City,,City+State+New Line+ZIP Code,ZIP Code+City+State;
                                                                    ESM=C.P.+Municipio/Ciudad,Municipio/Ciudad+C.P.,Municipio/Ciudad+Provincia+C.P.,L°nea en blanco+C.P.+Municipio/Ciudad,,Municipio/Ciudad+Provincia+L°nea nueva+C.P.,C.P.+Municipio/Ciudad+Provincia;
                                                                    FRC=Code postal+Ville,Ville+Code postal,Ville+ComtÇ+Code postal,Ligne vide+Code postal+Ville,,Ville+ComtÇ+Nouvelle ligne+Code postal,Code postal+Ville+ComtÇ;
                                                                    ENC=Postal/ZIP Code+City,City+Postal/ZIP Code,City+Province/State+Postal/ZIP Code,Blank Line+Postal/ZIP Code+City,,City+Province/State+New Line+Postal/ZIP Code,Postal/ZIP Code+City+Province/State];
                                                   OptionString=Post Code+City,City+Post Code,City+County+Post Code,Blank Line+Post Code+City,,City+County+New Line+Post Code,Post Code+City+County }
    { 58  ;   ;Inv. Rounding Precision (LCY);Decimal;
                                                   OnValidate=BEGIN
                                                                IF "Amount Rounding Precision" <> 0 THEN
                                                                  IF "Inv. Rounding Precision (LCY)" <> ROUND("Inv. Rounding Precision (LCY)","Amount Rounding Precision") THEN
                                                                    ERROR(
                                                                      Text004,
                                                                      FIELDCAPTION("Inv. Rounding Precision (LCY)"),"Amount Rounding Precision");
                                                              END;

                                                   CaptionML=[ENU=Inv. Rounding Precision ($);
                                                              ESM=Precisi¢n redondeo fact. ($);
                                                              FRC=PrÇcis. arrondis. fact. ($);
                                                              ENC=Inv. Rounding Precision ($)];
                                                   AutoFormatType=1 }
    { 59  ;   ;Inv. Rounding Type (LCY);Option    ;CaptionML=[ENU=Inv. Rounding Type ($);
                                                              ESM=Tipo redondeo fact. ($);
                                                              FRC=Type arrondis. facture ($);
                                                              ENC=Inv. Rounding Type ($)];
                                                   OptionCaptionML=[ENU=Nearest,Up,Down;
                                                                    ESM=M†s cercano,Superior,Inferior;
                                                                    FRC=Plus präs,Haut,Bas;
                                                                    ENC=Nearest,Up,Down];
                                                   OptionString=Nearest,Up,Down }
    { 60  ;   ;Local Cont. Addr. Format;Option    ;InitValue=After Company Name;
                                                   CaptionML=[ENU=Local Cont. Addr. Format;
                                                              ESM=Formato dir. contacto est†ndar;
                                                              FRC=Format adresse contact local;
                                                              ENC=Local Cont. Addr. Format];
                                                   OptionCaptionML=[ENU=First,After Company Name,Last;
                                                                    ESM=Primero,DespuÇs empresa,Èltimo;
                                                                    FRC=Premier,Apräs nom de compagnie,Dernier;
                                                                    ENC=First,After Company Name,Last];
                                                   OptionString=First,After Company Name,Last }
    { 63  ;   ;Bank Account Nos.   ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Bank Account Nos.;
                                                              ESM=Nß serie banco;
                                                              FRC=N¯ comptes bancaires;
                                                              ENC=Bank Account Nos.] }
    { 65  ;   ;Summarize G/L Entries;Boolean      ;CaptionML=[ENU=Summarize G/L Entries;
                                                              ESM=Resumir movs. C/G;
                                                              FRC=Sommaire des Çcriture de GL;
                                                              ENC=Summarize G/L Entries] }
    { 66  ;   ;Amount Decimal Places;Text5        ;InitValue=2:2;
                                                   OnValidate=BEGIN
                                                                CheckDecimalPlacesFormat("Amount Decimal Places");
                                                              END;

                                                   CaptionML=[ENU=Amount Decimal Places;
                                                              ESM=Nß decimales para importes;
                                                              FRC=Nombre dÇcimales montant;
                                                              ENC=Amount Decimal Places] }
    { 67  ;   ;Unit-Amount Decimal Places;Text5   ;InitValue=2:5;
                                                   OnValidate=BEGIN
                                                                CheckDecimalPlacesFormat("Unit-Amount Decimal Places");
                                                              END;

                                                   CaptionML=[ENU=Unit-Amount Decimal Places;
                                                              ESM=Nß decimales para precio-prod.;
                                                              FRC=Nombre dÇcimales montant unit.;
                                                              ENC=Unit-Amount Decimal Places] }
    { 68  ;   ;Additional Reporting Currency;Code10;
                                                   TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                IF ("Additional Reporting Currency" <> xRec."Additional Reporting Currency") THEN BEGIN
                                                                  IF "Additional Reporting Currency" = '' THEN
                                                                    OK :=
                                                                      CONFIRM(
                                                                        Text005 +
                                                                        Text006 +
                                                                        Text007,FALSE)
                                                                  ELSE
                                                                    OK :=
                                                                      CONFIRM(
                                                                        Text008 +
                                                                        Text010 +
                                                                        Text011 +
                                                                        Text020 +
                                                                        Text013,FALSE,AnalysisView.TABLECAPTION);
                                                                  IF NOT OK THEN BEGIN
                                                                    "Additional Reporting Currency" := xRec."Additional Reporting Currency";
                                                                    EXIT;
                                                                  END;
                                                                END;
                                                                IF ("Additional Reporting Currency" <> xRec."Additional Reporting Currency") AND
                                                                   ("Additional Reporting Currency" <> '')
                                                                THEN BEGIN
                                                                  AdjAddReportingCurr.SetAddCurr("Additional Reporting Currency");
                                                                  AdjAddReportingCurr.RUNMODAL;
                                                                  IF NOT AdjAddReportingCurr.IsExecuted THEN
                                                                    "Additional Reporting Currency" := xRec."Additional Reporting Currency";
                                                                END;
                                                                IF ("Additional Reporting Currency" <> xRec."Additional Reporting Currency") AND
                                                                   AdjAddReportingCurr.IsExecuted
                                                                THEN
                                                                  DeleteIntrastatJnl;
                                                                IF ("Additional Reporting Currency" <> xRec."Additional Reporting Currency") AND
                                                                   ("Additional Reporting Currency" <> '') AND
                                                                   AdjAddReportingCurr.IsExecuted
                                                                THEN
                                                                  DeleteAnalysisView;
                                                              END;

                                                   CaptionML=[ENU=Additional Reporting Currency;
                                                              ESM=Informaci¢n divisa adicional;
                                                              FRC=Devise additionnelle rapport;
                                                              ENC=Additional Reporting Currency] }
    { 69  ;   ;VAT Tolerance %     ;Decimal       ;OnValidate=BEGIN
                                                                IF "VAT Tolerance %" <> 0 THEN BEGIN
                                                                  TESTFIELD("Adjust for Payment Disc.",FALSE);
                                                                  TESTFIELD("Pmt. Disc. Excl. VAT",TRUE);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=VAT Tolerance %;
                                                              ESM=% tolerancia IVA;
                                                              FRC=% tolÇrance TVA;
                                                              ENC=VAT Tolerance %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 70  ;   ;EMU Currency        ;Boolean       ;CaptionML=[ENU=EMU Currency;
                                                              ESM=Divisa UME;
                                                              FRC=Devise U.M.E.;
                                                              ENC=EMU Currency] }
    { 71  ;   ;LCY Code            ;Code10        ;CaptionML=[ENU=LCY Code;
                                                              ESM=C¢d. divisa local;
                                                              FRC=Code DS;
                                                              ENC=LCY Code] }
    { 72  ;   ;VAT Exchange Rate Adjustment;Option;CaptionML=[ENU=Tax Exchange Rate Adjustment;
                                                              ESM=Tipo cambio ajuste IVA;
                                                              FRC=Ajustement taux de change taxe;
                                                              ENC=Tax Exchange Rate Adjustment];
                                                   OptionCaptionML=[ENU=No Adjustment,Adjust Amount,Adjust Additional-Currency Amount;
                                                                    ESM=No ajustar,Ajustar importe,Ajustar importe divisa-adicional;
                                                                    FRC=Aucun ajustement,Ajuster montant,Ajuster montant devise additionnelle;
                                                                    ENC=No Adjustment,Adjust Amount,Adjust Additional-Currency Amount];
                                                   OptionString=No Adjustment,Adjust Amount,Adjust Additional-Currency Amount }
    { 73  ;   ;Amount Rounding Precision;Decimal  ;InitValue=0.01;
                                                   OnValidate=BEGIN
                                                                IF "Amount Rounding Precision" <> 0 THEN
                                                                  "Inv. Rounding Precision (LCY)" := ROUND("Inv. Rounding Precision (LCY)","Amount Rounding Precision");
                                                                RoundingErrorCheck(FIELDCAPTION("Amount Rounding Precision"));
                                                                MESSAGE(
                                                                  Text021);
                                                              END;

                                                   CaptionML=[ENU=Amount Rounding Precision;
                                                              ESM=Prec. redondeo importe;
                                                              FRC=PrÇcision arrondis. montant;
                                                              ENC=Amount Rounding Precision];
                                                   DecimalPlaces=0:5 }
    { 74  ;   ;Unit-Amount Rounding Precision;Decimal;
                                                   InitValue=0.00001;
                                                   OnValidate=BEGIN
                                                                MESSAGE(
                                                                  Text022);
                                                              END;

                                                   CaptionML=[ENU=Unit-Amount Rounding Precision;
                                                              ESM=Prec. redondeo precio-prod.;
                                                              FRC=PrÇcis. arrondi. montant unit.;
                                                              ENC=Unit-Amount Rounding Precision];
                                                   DecimalPlaces=0:9 }
    { 75  ;   ;Appln. Rounding Precision;Decimal  ;CaptionML=[ENU=Appln. Rounding Precision;
                                                              ESM=Precisi¢n redondeo liquidaci¢n;
                                                              FRC=Arrondissement effectuÇ;
                                                              ENC=Appln. Rounding Precision];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 79  ;   ;Global Dimension 1 Code;Code20     ;TableRelation=Dimension;
                                                   OnValidate=BEGIN
                                                                "Shortcut Dimension 1 Code" := "Global Dimension 1 Code";
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              ESM=C¢d. dimensi¢n global 1;
                                                              FRC=Code de dimension principal 1;
                                                              ENC=Global Dimension 1 Code];
                                                   Editable=No }
    { 80  ;   ;Global Dimension 2 Code;Code20     ;TableRelation=Dimension;
                                                   OnValidate=BEGIN
                                                                "Shortcut Dimension 2 Code" := "Global Dimension 2 Code";
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              ESM=C¢d. dimensi¢n global 2;
                                                              FRC=Code de dimension principal 2;
                                                              ENC=Global Dimension 2 Code];
                                                   Editable=No }
    { 81  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation=Dimension;
                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              ESM=C¢d. dim. acceso dir. 1;
                                                              FRC=Code raccourci de dimension 1;
                                                              ENC=Shortcut Dimension 1 Code];
                                                   Editable=No }
    { 82  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation=Dimension;
                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              ESM=C¢d. dim. acceso dir. 2;
                                                              FRC=Code raccourci de dimension 2;
                                                              ENC=Shortcut Dimension 2 Code];
                                                   Editable=No }
    { 83  ;   ;Shortcut Dimension 3 Code;Code20   ;TableRelation=Dimension;
                                                   OnValidate=BEGIN
                                                                IF Dim.CheckIfDimUsed("Shortcut Dimension 3 Code",3,'','',0) THEN
                                                                  ERROR(Text023,Dim.GetCheckDimErr);
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 3 Code;
                                                              ESM=C¢d. dim. acceso directo 3;
                                                              FRC=Code raccourci de dimension 3;
                                                              ENC=Shortcut Dimension 3 Code] }
    { 84  ;   ;Shortcut Dimension 4 Code;Code20   ;TableRelation=Dimension;
                                                   OnValidate=BEGIN
                                                                IF Dim.CheckIfDimUsed("Shortcut Dimension 4 Code",4,'','',0) THEN
                                                                  ERROR(Text023,Dim.GetCheckDimErr);
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 4 Code;
                                                              ESM=C¢d. dim. acceso directo 4;
                                                              FRC=Code raccourci de dimension 4;
                                                              ENC=Shortcut Dimension 4 Code] }
    { 85  ;   ;Shortcut Dimension 5 Code;Code20   ;TableRelation=Dimension;
                                                   OnValidate=BEGIN
                                                                IF Dim.CheckIfDimUsed("Shortcut Dimension 5 Code",5,'','',0) THEN
                                                                  ERROR(Text023,Dim.GetCheckDimErr);
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 5 Code;
                                                              ESM=C¢d. dim. acceso directo 5;
                                                              FRC=Code raccourci de dimension 5;
                                                              ENC=Shortcut Dimension 5 Code] }
    { 86  ;   ;Shortcut Dimension 6 Code;Code20   ;TableRelation=Dimension;
                                                   OnValidate=BEGIN
                                                                IF Dim.CheckIfDimUsed("Shortcut Dimension 6 Code",6,'','',0) THEN
                                                                  ERROR(Text023,Dim.GetCheckDimErr);
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 6 Code;
                                                              ESM=C¢d. dim. acceso directo 6;
                                                              FRC=Code raccourci de dimension 6;
                                                              ENC=Shortcut Dimension 6 Code] }
    { 87  ;   ;Shortcut Dimension 7 Code;Code20   ;TableRelation=Dimension;
                                                   OnValidate=BEGIN
                                                                IF Dim.CheckIfDimUsed("Shortcut Dimension 7 Code",7,'','',0) THEN
                                                                  ERROR(Text023,Dim.GetCheckDimErr);
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 7 Code;
                                                              ESM=C¢d. dim. acceso directo 7;
                                                              FRC=Code raccourci de dimension 7;
                                                              ENC=Shortcut Dimension 7 Code] }
    { 88  ;   ;Shortcut Dimension 8 Code;Code20   ;TableRelation=Dimension;
                                                   OnValidate=BEGIN
                                                                IF Dim.CheckIfDimUsed("Shortcut Dimension 8 Code",8,'','',0) THEN
                                                                  ERROR(Text023,Dim.GetCheckDimErr);
                                                                MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 8 Code;
                                                              ESM=C¢d. dim. acceso directo 8;
                                                              FRC=Code raccourci de dimension 8;
                                                              ENC=Shortcut Dimension 8 Code] }
    { 89  ;   ;Max. VAT Difference Allowed;Decimal;OnValidate=BEGIN
                                                                IF "Max. VAT Difference Allowed" <> ROUND("Max. VAT Difference Allowed") THEN
                                                                  ERROR(
                                                                    Text004,
                                                                    FIELDCAPTION("Max. VAT Difference Allowed"),"Amount Rounding Precision");

                                                                "Max. VAT Difference Allowed" := ABS("Max. VAT Difference Allowed");
                                                              END;

                                                   CaptionML=[ENU=Max. Tax Difference Allowed;
                                                              ESM=M†x. diferencia IVA permitida;
                                                              FRC=DiffÇrence TVA max. autorisÇe;
                                                              ENC=Max. Tax Difference Allowed];
                                                   AutoFormatType=1 }
    { 90  ;   ;VAT Rounding Type   ;Option        ;CaptionML=[ENU=Tax Rounding Type;
                                                              ESM=Tipo redondeo IVA;
                                                              FRC=Type arrondi TVA;
                                                              ENC=Tax Rounding Type];
                                                   OptionCaptionML=[ENU=Nearest,Up,Down;
                                                                    ESM=M†s cercano,Superior,Inferior;
                                                                    FRC=Plus präs,Haut,Bas;
                                                                    ENC=Nearest,Up,Down];
                                                   OptionString=Nearest,Up,Down }
    { 92  ;   ;Pmt. Disc. Tolerance Posting;Option;CaptionML=[ENU=Pmt. Disc. Tolerance Posting;
                                                              ESM=Registrar tolerancia dto. P.P.;
                                                              FRC=Report tolÇr. escompte paiem.;
                                                              ENC=Pmt. Disc. Tolerance Posting];
                                                   OptionCaptionML=[ENU=Payment Tolerance Accounts,Payment Discount Accounts;
                                                                    ESM=Ctas. tolerancia pagos,Ctas. dto. P.P.;
                                                                    FRC=Comptes de  tolÇrance de paiement,Comptes d'escompte de paiement;
                                                                    ENC=Payment Tolerance Accounts,Payment Discount Accounts];
                                                   OptionString=Payment Tolerance Accounts,Payment Discount Accounts }
    { 93  ;   ;Payment Discount Grace Period;DateFormula;
                                                   CaptionML=[ENU=Payment Discount Grace Period;
                                                              ESM=Periodo gracia descuento pagos;
                                                              FRC=PÇriode carence escompte;
                                                              ENC=Payment Discount Grace Period] }
    { 94  ;   ;Payment Tolerance % ;Decimal       ;CaptionML=[ENU=Payment Tolerance %;
                                                              ESM=% Tolerancia pago;
                                                              FRC=% Çcart de räglement;
                                                              ENC=Payment Tolerance %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100;
                                                   Editable=No }
    { 95  ;   ;Max. Payment Tolerance Amount;Decimal;
                                                   CaptionML=[ENU=Max. Payment Tolerance Amount;
                                                              ESM=M†x. importe tolerancia pago;
                                                              FRC=Montant Çcart räglement max.;
                                                              ENC=Max. Payment Tolerance Amount];
                                                   MinValue=0;
                                                   Editable=No }
    { 96  ;   ;Adapt Main Menu to Permissions;Boolean;
                                                   InitValue=Yes;
                                                   CaptionML=[ENU=Adapt Main Menu to Permissions;
                                                              ESM=Adaptar men£ princ. a permisos;
                                                              FRC=Adapter menu princ. aux perm.;
                                                              ENC=Adapt Main Menu to Permissions] }
    { 97  ;   ;Allow G/L Acc. Deletion Before;Date;CaptionML=[ENU=Allow G/L Acc. Deletion Before;
                                                              ESM=Permite borrar ctas. anteriores a;
                                                              FRC=Perm. sup. ctes gr. liv. avant;
                                                              ENC=Allow G/L Acc. Deletion Before] }
    { 98  ;   ;Check G/L Account Usage;Boolean    ;CaptionML=[ENU=Check G/L Account Usage;
                                                              ESM=Chequear utiliz. ctas. cont.;
                                                              FRC=VÇrif. usage cptes grand livre;
                                                              ENC=Check G/L Account Usage] }
    { 99  ;   ;Payment Tolerance Posting;Option   ;CaptionML=[ENU=Payment Tolerance Posting;
                                                              ESM=Registrar tolerancia pagos;
                                                              FRC=Report tolÇrance du paiement;
                                                              ENC=Payment Tolerance Posting];
                                                   OptionCaptionML=[ENU=Payment Tolerance Accounts,Payment Discount Accounts;
                                                                    ESM=Ctas. tolerancia pagos,Ctas. dto. P.P.;
                                                                    FRC="Comptes de  tolÇrance de paiement,Comptes d'escompte de paiement  ";
                                                                    ENC=Payment Tolerance Accounts,Payment Discount Accounts];
                                                   OptionString=Payment Tolerance Accounts,Payment Discount Accounts }
    { 100 ;   ;Pmt. Disc. Tolerance Warning;Boolean;
                                                   CaptionML=[ENU=Pmt. Disc. Tolerance Warning;
                                                              ESM=Advertencia tolerancia dto. P.P.;
                                                              FRC=Avert. tolÇr. escompte paiem.;
                                                              ENC=Pmt. Disc. Tolerance Warning] }
    { 101 ;   ;Payment Tolerance Warning;Boolean  ;CaptionML=[ENU=Payment Tolerance Warning;
                                                              ESM=Advertencia tolerancia pagos;
                                                              FRC=Avertiss. tolÇrance paiement;
                                                              ENC=Payment Tolerance Warning] }
    { 102 ;   ;Last IC Transaction No.;Integer    ;CaptionML=[ENU=Last IC Transaction No.;
                                                              ESM=Nß £ltima transacci¢n IC;
                                                              FRC=Dernier n¯ de transaction IC;
                                                              ENC=Last IC Transaction No.] }
    { 103 ;   ;Bill-to/Sell-to VAT Calc.;Option   ;CaptionML=[ENU=Bill-to/Sell-to VAT Calc.;
                                                              ESM=Fact./Venta a-C†lc. IVA;
                                                              FRC=Calc. TVA facturation/dÇbiteur;
                                                              ENC=Bill-to/Sell-to VAT Calc.];
                                                   OptionCaptionML=[ENU=Bill-to/Pay-to No.,Sell-to/Buy-from No.;
                                                                    ESM=Fact./Pago a-Nß.,Venta/Compra a-Nß.;
                                                                    FRC=N¯ facturation/crÇancier,N¯dÇbiteur/fournisseur;
                                                                    ENC=Bill-to/Pay-to No.,Sell-to/Buy-from No.];
                                                   OptionString=Bill-to/Pay-to No.,Sell-to/Buy-from No. }
    { 150 ;   ;Print VAT specification in LCY;Boolean;
                                                   CaptionML=[ENU=Print tax specification in $;
                                                              ESM=Imprimir especificaci¢n IVA en $;
                                                              FRC=Imprimer le dÇtail TVA en $;
                                                              ENC=Print Tax specification in $] }
    { 151 ;   ;Prepayment Unrealized VAT;Boolean  ;OnValidate=BEGIN
                                                                IF "Unrealized VAT" AND xRec."Prepayment Unrealized VAT"  THEN
                                                                  ERROR(Text024,FIELDCAPTION("Prepayment Unrealized VAT"),FIELDCAPTION("Unrealized VAT"));

                                                                IF NOT "Prepayment Unrealized VAT" THEN BEGIN
                                                                  VATPostingSetup.SETFILTER(
                                                                    "Unrealized VAT Type",'>=%1',VATPostingSetup."Unrealized VAT Type"::Percentage);
                                                                  IF VATPostingSetup.FIND('-') THEN
                                                                    ERROR(
                                                                      Text000,VATPostingSetup.TABLECAPTION,
                                                                      VATPostingSetup."VAT Bus. Posting Group",VATPostingSetup."VAT Prod. Posting Group",
                                                                      VATPostingSetup.FIELDCAPTION("Unrealized VAT Type"),VATPostingSetup."Unrealized VAT Type");
                                                                  TaxJurisdiction.SETFILTER(
                                                                    "Unrealized VAT Type",'>=%1',TaxJurisdiction."Unrealized VAT Type"::Percentage);
                                                                  IF TaxJurisdiction.FIND('-') THEN
                                                                    ERROR(
                                                                      Text001,TaxJurisdiction.TABLECAPTION,
                                                                      TaxJurisdiction.Code,TaxJurisdiction.FIELDCAPTION("Unrealized VAT Type"),
                                                                      TaxJurisdiction."Unrealized VAT Type");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prepayment Unrealized Tax;
                                                              ESM=IVA no realizado de anticipo;
                                                              FRC=TVA non matÇrialisÇe sur paiement anticipÇ;
                                                              ENC=Prepayment Unrealized Tax] }
    { 10001;  ;VAT in Use          ;Boolean       ;CaptionML=[ENU=VAT in Use;
                                                              ESM=IVA en uso;
                                                              FRC=TVA en utilisation;
                                                              ENC=VAT in Use] }
    { 10002;  ;Bank Rec. Adj. Doc. Nos.;Code10    ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Bank Rec. Adj. Doc. Nos.;
                                                              ESM=Nros. doc. ajuste concil.;
                                                              FRC=Nos de doc. ajustement rappr. bancaire;
                                                              ENC=Bank Rec. Adj. Doc. Nos.] }
    { 10003;  ;Deposit Nos.        ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=Deposit Nos.;
                                                              ESM=Nros. dep¢sitos;
                                                              FRC=N¯ de dÇpìts;
                                                              ENC=Deposit Nos.] }
    { 50000;  ;Currency Webservice URL;Text150     }
    { 50001;  ;Currency Webservice Method;Text150  }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=%1 %2 %3 have %4 to %5.;ESM=%1 %2 %3 tiene %4 a %5.;FRC=%1 %2 %3 a %4 Ö %5.;ENC=%1 %2 %3 have %4 to %5.';
      Text001@1001 : TextConst 'ENU=%1 %2 have %3 to %4.;ESM=%1 %2 tiene %3 a %4.;FRC=%1 %2 a %3 Ö %4.;ENC=%1 %2 have %3 to %4.';
      Text002@1002 : TextConst 'ENU=%1 %2 %3 use %4.;ESM=%1 %2 %3 utilice %4.;FRC=%1 %2 %3 utilise %4.;ENC=%1 %2 %3 use %4.';
      Text003@1003 : TextConst 'ENU=%1 %2 use %3.;ESM=%1 %2 utiliza %3.;FRC=%1 %2 utilise %3.;ENC=%1 %2 use %3.';
      Text004@1004 : TextConst 'ENU=%1 must be rounded to the nearest %2.;ESM=Se debe redondear %1 al m†s cercano %2.;FRC=%1 doit àtre arrondi au plus präs de %2.;ENC=%1 must be rounded to the nearest %2.';
      Text005@1005 : TextConst 'ENU=If you delete the additional reporting currency, future general ledger entries will be posted in $ only.;ESM=Si elimina la inf. divisa adicional, los siguientes movs. s¢lo se registrar†n en divisa local.;FRC=Si vous supprimez la devise additionnelle de rapport, les Çcritures au grand livre futures seront reportÇes en $ seulement.;ENC=If you delete the additional reporting currency, future general ledger entries will be posted in $ only.';
      Text006@1006 : TextConst 'ENU=Deleting the additional reporting currency will have no effect on already posted general ledger entries.\\;ESM=Si se elimina la inf. en divisa adicional no se alteran los movs. ya registrados.\\;FRC=Supprimer la devise additionnelle de rapport n''aura aucun effet sur les Çcritures de grand livre dÇjÖ reportÇes.\\;ENC=Deleting the additional reporting currency will have no effect on already posted general ledger entries.\\';
      Text007@1007 : TextConst 'ENU=Do you want to delete the additional reporting currency?;ESM=®Confirma que desea eliminar la divisa adicional para informes?;FRC=Voulez-vous supprimer la devise additionnelle de rapport?;ENC=Do you want to delete the additional reporting currency?';
      Text008@1008 : TextConst 'ENU="If you change the additional reporting currency, future general ledger entries will be posted in the new reporting currency (and in $).  ";ESM="Si cambia la informaci¢n en divisa adicional, los movs. contabilidad futuros se registrar†n en la nueva divisa de informaci¢n ( y en $).  ";FRC="Si vous modifiez la devise de rapport, les prochaines Çcritures comptables seront validÇes dans la nouvelle devise de rapport (et en $).  ";ENC="If you change the additional reporting currency, future general ledger entries will be posted in the new reporting currency (and in $).  "';
      Text010@1010 : TextConst 'ENU="If you change the additional reporting currency, a batch job will appear. ";ESM="Si cambia la informaci¢n en divisa adicional, aparecer† un proceso. ";FRC="Si vous changez la devise additionnelle de rapport, un traitement par lots apparaåtra. ";ENC="If you change the additional reporting currency, a batch job will appear. "';
      Text011@1011 : TextConst 'ENU=Running this batch job will cause the program to recalculate already posted general ledger entries in the new additional reporting currency.\;ESM=Ejecutar este proceso provocar† que el programa recalcule los movimientos de contabilidad registrados en el nuevo informe divisa adicional.\;FRC=Si vous lancez ce traitement par lots, le programme recalculera des Çcritures comptables dÇjÖ validÇes dans la nouvelle devise de rapport.\;ENC=Running this batch job will cause the program to recalculate already posted general ledger entries in the new additional reporting currency.\';
      Text013@1012 : TextConst 'ENU=Do you want to change the additional reporting currency?;ESM=®Confirma que desea cambiar la divisa adicional?;FRC=Voulez-vous changer la devise additionnelle de rapport?;ENC=Do you want to change the additional reporting currency?';
      Text016@1013 : TextConst 'ENU="Enter one number or two numbers separated by a colon. ";ESM="Introduzca uno o dos n£meros separados por dos puntos. ";FRC="Entrer un ou deux numÇro(s) sÇparÇs par deux points (:). ";ENC="Enter one number or two numbers separated by a colon. "';
      Text017@1014 : TextConst 'ENU=The online Help for this field describes how you can fill in the field.;ESM=La ayuda en l°nea describe c¢mo utilizar este campo.;FRC=L''aide en ligne pour ce champ dÇcrit comment remplir ce champ.;ENC=The online Help for this field describes how you can fill in the field.';
      Text018@1015 : TextConst 'ENU=You cannot change the contents of the %1 field because there are posted ledger entries.;ESM=No se puede cambiar el contenido del campo %1 ya que hay movs. registrados.;FRC=Vous ne pouvez changer le contenu du champ %1 parce qu''il y a des Çcritures reportÇes.;ENC=You cannot change the contents of the %1 field because there are posted ledger entries.';
      Text020@1017 : TextConst 'ENU=Entries will be deleted in the %1 if it is unblocked. An update will be necessary.\\;ESM=El %1 de movs. se borrar†n si est† desbloqueado. Ser† necesario una actualizaci¢n.\\;FRC=Le dÇblocage provoquera la suppression des Çcritures de %1. Une mise Ö jour sera nÇcessaire.\\;ENC=Entries will be deleted in the %1 if it is unblocked. An update will be necessary.\\';
      Text021@1018 : TextConst 'ENU=You must close the program and start again in order to activate the amount-rounding feature.;ESM=Debe cerrar el programa y entrar de nuevo para activar la prop. de redondeo-importe.;FRC=Vous devez fermer le programme, puis le redÇmarrer pour activer la fonction d''arrondissement des montants.;ENC=You must close the program and start again in order to activate the amount-rounding feature.';
      Text022@1019 : TextConst 'ENU=You must close the program and start again in order to activate the unit-amount rounding feature.;ESM=Debe cerrar el programa y entrar de nuevo para activar la prop. de redondeo precio-producto.;FRC=Vous devez fermer le programme, puis le redÇmarrer pour activer la fonction d''arrondissement des unitÇs.;ENC=You must close the program and start again in order to activate the unit-amount rounding feature.';
      Text023@1020 : TextConst 'ENU=%1\You cannot use the same dimension twice in the same setup.;ESM=%1\No puede usar la misma dim. dos veces en la misma config.;FRC=%1\Vous ne pouvez pas utiliser le màme axe analytique deux fois dans le màme paramÇtrage.;ENC=%1\You cannot use the same dimension twice in the same setup.';
      Dim@1021 : Record 348;
      GLEntry@1022 : Record 17;
      ItemLedgerEntry@1023 : Record 32;
      JobLedgEntry@1024 : Record 169;
      ResLedgEntry@1025 : Record 203;
      FALedgerEntry@1026 : Record 5601;
      MaintenanceLedgerEntry@1027 : Record 5625;
      InsCoverageLedgerEntry@1028 : Record 5629;
      VATPostingSetup@1029 : Record 325;
      TaxJurisdiction@1030 : Record 320;
      AdjAddReportingCurr@1031 : Report 86;
      AnalysisView@1032 : Record 363;
      AnalysisViewEntry@1033 : Record 365;
      AnalysisViewBudgetEntry@1034 : Record 366;
      OK@1035 : Boolean;
      ErrorMessage@1036 : Boolean;
      Text024@1009 : TextConst 'ENU=You cannot change the contents of the %1 field because the %2 is activated.;ESM=No puede cambiar el contenido del campo %1 porque el %2 est† activado.;FRC=Vous ne pouvez pas modifier le contenu du champ %1 en raison de l''activation de %2.;ENC=You cannot change the contents of the %1 field because the %2 is activated.';

    PROCEDURE CheckDecimalPlacesFormat@1(VAR DecimalPlaces@1000 : Text[5]);
    VAR
      OK@1001 : Boolean;
      ColonPlace@1002 : Integer;
      DecimalPlacesPart1@1003 : Integer;
      DecimalPlacesPart2@1004 : Integer;
      Check@1005 : Text[5];
    BEGIN
      OK := TRUE;
      ColonPlace := STRPOS(DecimalPlaces,':');

      IF ColonPlace = 0 THEN BEGIN
        IF NOT EVALUATE(DecimalPlacesPart1,DecimalPlaces) THEN
          OK := FALSE;
        IF (DecimalPlacesPart1 < 0) OR (DecimalPlacesPart1 > 9) THEN
          OK := FALSE;
      END ELSE BEGIN
        Check := COPYSTR(DecimalPlaces,1,ColonPlace - 1);
        IF Check = '' THEN
          OK := FALSE;
        IF NOT EVALUATE(DecimalPlacesPart1,Check) THEN
          OK := FALSE;
        Check := COPYSTR(DecimalPlaces,ColonPlace + 1,STRLEN(DecimalPlaces));
        IF Check = '' THEN
          OK := FALSE;
        IF NOT EVALUATE(DecimalPlacesPart2,Check) THEN
          OK := FALSE;
        IF DecimalPlacesPart1 > DecimalPlacesPart2 THEN
          OK := FALSE;
        IF (DecimalPlacesPart1 < 0) OR (DecimalPlacesPart1 > 9) THEN
          OK := FALSE;
        IF (DecimalPlacesPart2 < 0) OR (DecimalPlacesPart2 > 9) THEN
          OK := FALSE;
      END;

      IF NOT OK THEN
        ERROR(
          Text016 +
          Text017);

      IF ColonPlace = 0 THEN
        DecimalPlaces := FORMAT(DecimalPlacesPart1)
      ELSE
        DecimalPlaces := STRSUBSTNO('%1:%2',DecimalPlacesPart1,DecimalPlacesPart2);
    END;

    PROCEDURE RoundingErrorCheck@2(NameOfField@1000 : Text[100]);
    BEGIN
      ErrorMessage := FALSE;
      IF GLEntry.FIND('-') THEN
        ErrorMessage := TRUE;
      IF ItemLedgerEntry.FIND('-') THEN
        ErrorMessage := TRUE;
      IF JobLedgEntry.FIND('-') THEN
        ErrorMessage := TRUE;
      IF ResLedgEntry.FIND('-') THEN
        ErrorMessage := TRUE;
      IF FALedgerEntry.FIND('-') THEN
        ErrorMessage := TRUE;
      IF MaintenanceLedgerEntry.FIND('-') THEN
        ErrorMessage := TRUE;
      IF InsCoverageLedgerEntry.FIND('-') THEN
        ErrorMessage := TRUE;
      IF ErrorMessage THEN
        ERROR(
          Text018,
          NameOfField);
    END;

    PROCEDURE DeleteIntrastatJnl@3();
    VAR
      IntrastatJnlBatch@1000 : Record 262;
      IntrastatJnlLine@1001 : Record 263;
    BEGIN
      IntrastatJnlBatch.SETRANGE(Reported,FALSE);
      IntrastatJnlBatch.SETRANGE("Amounts in Add. Currency",TRUE);
      IF IntrastatJnlBatch.FIND('-') THEN
        REPEAT
          IntrastatJnlLine.SETRANGE("Journal Template Name",IntrastatJnlBatch."Journal Template Name");
          IntrastatJnlLine.SETRANGE("Journal Batch Name",IntrastatJnlBatch.Name);
          IntrastatJnlLine.DELETEALL;
        UNTIL IntrastatJnlBatch.NEXT = 0;
    END;

    PROCEDURE DeleteAnalysisView@33();
    BEGIN
      IF AnalysisView.FIND('-') THEN BEGIN
        REPEAT
          IF AnalysisView.Blocked = FALSE THEN BEGIN
            AnalysisViewEntry.SETRANGE("Analysis View Code",AnalysisView.Code);
            AnalysisViewEntry.DELETEALL;
            AnalysisViewBudgetEntry.SETRANGE("Analysis View Code",AnalysisView.Code);
            AnalysisViewBudgetEntry.DELETEALL;
            AnalysisView."Last Entry No." := 0;
            AnalysisView."Last Budget Entry No." := 0;
            AnalysisView."Last Date Updated" := 0D;
            AnalysisView.MODIFY;
          END ELSE BEGIN
            AnalysisView."Refresh When Unblocked" := TRUE;
            AnalysisView.MODIFY;
          END;
        UNTIL AnalysisView.NEXT = 0;
      END;
    END;

    PROCEDURE IsPostingAllowed@22(PostingDate@1000 : Date) : Boolean;
    BEGIN
      EXIT(PostingDate >= "Allow Posting From");
    END;

    PROCEDURE FirstAllowedPostingDate@78() AllowedPostingDate : Date;
    VAR
      InvtPeriod@1000 : Record 5814;
    BEGIN
      AllowedPostingDate := "Allow Posting From";
      IF NOT InvtPeriod.IsValidDate(AllowedPostingDate) THEN
        AllowedPostingDate := CALCDATE('<+1D>',AllowedPostingDate);
    END;

    BEGIN
    {
      WMI0001 SK  11/07/11: Added new field Currency Webservice URL.
    }
    END.
  }
}

OBJECT Form 5 Currencies
{
  OBJECT-PROPERTIES
  {
    Date=11/07/11;
    Time=11:06:47 AM;
    Modified=Yes;
    Version List=NAVW14.00.01,NAVNA5.00;
  }
  PROPERTIES
  {
    Width=16500;
    Height=6710;
    CaptionML=[ENU=Currencies;
               ESM=Divisas;
               FRC=Devises;
               ENC=Currencies];
    TableBoxID=1;
    SourceTable=Table4;
  }
  CONTROLS
  {
    { 1   ;TableBox     ;220  ;220  ;16060;5500 ;HorzGlue=Both;
                                                 VertGlue=Both }
    { 2   ;TextBox      ;0    ;0    ;1100 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Code }
    { 3   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=2;
                                                 InColumnHeading=Yes }
    { 29  ;TextBox      ;847  ;1980 ;4400 ;440  ;HorzGlue=Both;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Description }
    { 30  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=29;
                                                 InColumnHeading=Yes }
    { 1480000;TextBox   ;5503 ;440  ;550  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr=Symbol }
    { 1480001;Label     ;0    ;0    ;0    ;0    ;ParentControl=1480000;
                                                 InColumnHeading=Yes }
    { 44  ;CheckBox     ;5186 ;440  ;550  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="EMU Currency" }
    { 45  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=44;
                                                 InColumnHeading=Yes }
    { 6   ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Realized Gains Acc." }
    { 7   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=6;
                                                 InColumnHeading=Yes }
    { 21  ;TextBox      ;9958 ;660  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Realized Losses Acc." }
    { 22  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=21;
                                                 InColumnHeading=Yes }
    { 8   ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Unrealized Gains Acc." }
    { 9   ;Label        ;0    ;0    ;0    ;0    ;ParentControl=8;
                                                 InColumnHeading=Yes }
    { 19  ;TextBox      ;8308 ;660  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Unrealized Losses Acc." }
    { 20  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=19;
                                                 InColumnHeading=Yes }
    { 5   ;TextBox      ;14817;550  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Realized G/L Gains Account" }
    { 17  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=5;
                                                 InColumnHeading=Yes }
    { 18  ;TextBox      ;16467;550  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Realized G/L Losses Account" }
    { 33  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=18;
                                                 InColumnHeading=Yes }
    { 46  ;TextBox      ;16087;550  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Residual Gains Account" }
    { 47  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=46;
                                                 InColumnHeading=Yes }
    { 48  ;TextBox      ;12885;550  ;1650 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Residual Losses Account" }
    { 49  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=48;
                                                 InColumnHeading=Yes }
    { 25  ;TextBox      ;2461 ;770  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Amount Rounding Precision" }
    { 26  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=25;
                                                 InColumnHeading=Yes }
    { 36  ;TextBox      ;12727;440  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Amount Decimal Places" }
    { 37  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=36;
                                                 InColumnHeading=Yes }
    { 23  ;TextBox      ;13703;660  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Invoice Rounding Precision" }
    { 24  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=23;
                                                 InColumnHeading=Yes }
    { 27  ;TextBox      ;14896;660  ;550  ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Invoice Rounding Type" }
    { 28  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=27;
                                                 InColumnHeading=Yes }
    { 31  ;TextBox      ;14102;2750 ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Unit-Amount Rounding Precision" }
    { 32  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=31;
                                                 InColumnHeading=Yes }
    { 38  ;TextBox      ;15293;440  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Unit-Amount Decimal Places" }
    { 39  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=38;
                                                 InColumnHeading=Yes }
    { 42  ;TextBox      ;25823;440  ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Appln. Rounding Precision" }
    { 43  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=42;
                                                 InColumnHeading=Yes }
    { 50  ;TextBox      ;33321;2420 ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Conv. LCY Rndg. Debit Acc." }
    { 51  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=50;
                                                 InColumnHeading=Yes }
    { 52  ;TextBox      ;34971;2420 ;1650 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Conv. LCY Rndg. Credit Acc." }
    { 53  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=52;
                                                 InColumnHeading=Yes }
    { 54  ;TextBox      ;28866;2200 ;2200 ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Max. VAT Difference Allowed" }
    { 55  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=54;
                                                 InColumnHeading=Yes }
    { 56  ;TextBox      ;31195;3190 ;550  ;440  ;Visible=No;
                                                 ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="VAT Rounding Type" }
    { 57  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=56;
                                                 InColumnHeading=Yes }
    { 10  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Last Date Adjusted" }
    { 11  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=10;
                                                 InColumnHeading=Yes }
    { 12  ;TextBox      ;0    ;0    ;1650 ;0    ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Last Date Modified" }
    { 13  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=12;
                                                 InColumnHeading=Yes }
    { 34  ;TextBox      ;37703;330  ;2200 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Payment Tolerance %" }
    { 35  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=34;
                                                 InColumnHeading=Yes }
    { 1000000000;CheckBox;41910;330 ;1700 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 ShowCaption=No;
                                                 SourceExpr="Update Exchange Rate" }
    { 1000000001;Label  ;0    ;0    ;0    ;0    ;ParentControl=1000000000;
                                                 InColumnHeading=Yes }
    { 58  ;TextBox      ;39903;330  ;2200 ;440  ;ParentControl=1;
                                                 InColumn=Yes;
                                                 SourceExpr="Max. Payment Tolerance Amount" }
    { 59  ;Label        ;0    ;0    ;0    ;0    ;ParentControl=58;
                                                 InColumnHeading=Yes }
    { 14  ;CommandButton;1980 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 15  ;CommandButton;4400 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 16  ;CommandButton;14080;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 4   ;CommandButton;11660;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=RunObject;
                                                 CaptionML=[ENU=Exch. &Rates;
                                                            ESM=Tipo &cambio;
                                                            FRC=&Taux de change;
                                                            ENC=Exch. &Rates];
                                                 RunObject=Form 483;
                                                 RunFormLinkType=OnUpdate;
                                                 RunFormLink=Currency Code=FIELD(Code) }
    { 40  ;MenuButton   ;6820 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=&Currency;
                                                            ESM=&Divisa;
                                                            FRC=&Devise;
                                                            ENC=&Currency];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=41;
                                                     PushAction=RunObject;
                                                     ShortCutKey=Shift+F5;
                                                     CaptionML=[ENU=Card;
                                                                ESM=Ficha;
                                                                FRC=Fiche;
                                                                ENC=Card];
                                                     RunObject=Form 495;
                                                     RunFormLinkType=OnUpdate;
                                                     RunFormLink=Code=FIELD(Code) }
                                                 }
                                                  }
    { 60  ;MenuButton   ;9240 ;5940 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=F&unctions;
                                                            ESM=Acci&ones;
                                                            FRC=F&onctions;
                                                            ENC=F&unctions];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=61;
                                                     CaptionML=[ENU=Change Payment &Tolerance;
                                                                ESM=Cambiar &tolerancia pagos;
                                                                FRC=Modifier la &tolÇrance de paiement;
                                                                ENC=Change Payment &Tolerance];
                                                     OnPush=VAR
                                                              ChangePmtTol@1001 : Report 34;
                                                            BEGIN
                                                              ChangePmtTol.SetCurrency(Rec);
                                                              ChangePmtTol.RUNMODAL;
                                                            END;
                                                             }
                                                   { ID=1000000002;
                                                     CaptionML=ENU=Update Exchange Rates;
                                                     OnPush=VAR
                                                              CurrencyWebService@1000000000 : Codeunit 50010;
                                                            BEGIN
                                                              // WMI0001 >>
                                                              CurrencyWebService.UpdateExchangeRates;
                                                              // WMI0001 <<
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {

    PROCEDURE GetSelectionFilter@2() : Code[80];
    VAR
      Currency@1000 : Record 4;
      FirstCurrency@1001 : Code[30];
      LastCurrency@1002 : Code[30];
      SelectionFilter@1003 : Code[250];
      CurrencyCount@1004 : Integer;
      More@1005 : Boolean;
    BEGIN
      CurrForm.SETSELECTIONFILTER(Currency);
      CurrencyCount := Currency.COUNT;
      IF CurrencyCount > 0 THEN BEGIN
        Currency.FIND('-');
        WHILE CurrencyCount > 0 DO BEGIN
          CurrencyCount := CurrencyCount - 1;
          Currency.MARKEDONLY(FALSE);
          FirstCurrency := Currency.Code;
          LastCurrency := FirstCurrency;
          More := (CurrencyCount > 0);
          WHILE More DO
            IF Currency.NEXT = 0 THEN
              More := FALSE
            ELSE
              IF NOT Currency.MARK THEN
                More := FALSE
              ELSE BEGIN
                LastCurrency := Currency.Code;
                CurrencyCount := CurrencyCount - 1;
                IF CurrencyCount = 0 THEN
                  More := FALSE;
              END;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          IF FirstCurrency = LastCurrency THEN
            SelectionFilter := SelectionFilter + FirstCurrency
          ELSE
            SelectionFilter := SelectionFilter + FirstCurrency + '..' + LastCurrency;
          IF CurrencyCount > 0 THEN BEGIN
            Currency.MARKEDONLY(TRUE);
            Currency.NEXT;
          END;
        END;
      END;
      EXIT(SelectionFilter);
    END;

    PROCEDURE GetCurrency@1(VAR "Currency Code"@1000 : Code[10]);
    BEGIN
      "Currency Code" := Rec.Code;
    END;

    BEGIN
    {
      WMI0001 SK  11/07/11: Added field "Update Exchange Rate".
    }
    END.
  }
}

OBJECT Form 118 General Ledger Setup
{
  OBJECT-PROPERTIES
  {
    Date=11/07/11;
    Time=11:04:11 AM;
    Modified=Yes;
    Version List=NAVW15.00.01,NAVUS3.70,FP;
  }
  PROPERTIES
  {
    Width=13420;
    Height=8470;
    CaptionML=[ENU=General Ledger Setup;
               ESM=Configuraci¢n contabilidad;
               FRC=Configuration du grand livre;
               ENC=General Ledger Setup];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table98;
    OnOpenForm=BEGIN
                 RESET;
                 IF NOT GET THEN
                   INSERT;

                 CurrForm.UPDATECONTROLS;
               END;

  }
  CONTROLS
  {
    { 1   ;TabControl   ;220  ;220  ;12980;7260 ;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 PageNamesML=[ENU=General,Numbering,Dimensions,Reporting,Application;
                                                              ESM=General,Numeraci¢n,Dimensiones,Informes,Liquidaci¢n;
                                                              FRC=GÇnÇral,NumÇrotation,Dimensions,Rapport,Taxe de vente;
                                                              ENC=General,Numbering,Dimensions,Reporting,Application] }
    { 6   ;TextBox      ;3850 ;990  ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Allow Posting From" }
    { 7   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=6;
                                                 InPage=0 }
    { 8   ;TextBox      ;3850 ;1540 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Allow Posting To" }
    { 9   ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=8;
                                                 InPage=0 }
    { 67  ;TextBox      ;3850 ;2860 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Local Address Format" }
    { 68  ;Label        ;440  ;2860 ;3300 ;440  ;ParentControl=67 }
    { 73  ;TextBox      ;3850 ;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Local Cont. Addr. Format" }
    { 74  ;Label        ;440  ;3410 ;3300 ;440  ;ParentControl=73 }
    { 14  ;CheckBox     ;10230;990  ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="EMU Currency" }
    { 15  ;Label        ;6820 ;990  ;3300 ;440  ;ParentControl=14 }
    { 18  ;TextBox      ;10230;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="LCY Code" }
    { 19  ;Label        ;6820 ;1540 ;3300 ;440  ;ParentControl=18 }
    { 43  ;CheckBox     ;3850 ;2200 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="Register Time" }
    { 45  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=43 }
    { 3   ;TextBox      ;10230;5060 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="VAT Rounding Type" }
    { 4   ;Label        ;6820 ;5060 ;3300 ;440  ;ParentControl=3 }
    { 5   ;TextBox      ;10230;4510 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Max. VAT Difference Allowed" }
    { 20  ;Label        ;6820 ;4510 ;3300 ;440  ;ParentControl=5 }
    { 21  ;CheckBox     ;10230;3410 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="Unrealized VAT" }
    { 46  ;Label        ;6820 ;3410 ;3300 ;440  ;ParentControl=21 }
    { 47  ;CheckBox     ;10230;2750 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="Adjust for Payment Disc." }
    { 48  ;Label        ;6820 ;2750 ;3300 ;440  ;ParentControl=47 }
    { 49  ;CheckBox     ;10230;2200 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="Pmt. Disc. Excl. VAT" }
    { 50  ;Label        ;6820 ;2200 ;3300 ;440  ;ParentControl=49 }
    { 75  ;TextBox      ;3850 ;4510 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Inv. Rounding Type (LCY)" }
    { 76  ;Label        ;440  ;4510 ;3300 ;440  ;ParentControl=75 }
    { 77  ;TextBox      ;3850 ;3960 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Inv. Rounding Precision (LCY)" }
    { 78  ;Label        ;440  ;3960 ;3300 ;440  ;ParentControl=77 }
    { 55  ;TextBox      ;3850 ;5170 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Allow G/L Acc. Deletion Before" }
    { 56  ;Label        ;440  ;5170 ;3300 ;440  ;ParentControl=55 }
    { 60  ;CheckBox     ;3850 ;5720 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="Check G/L Account Usage" }
    { 69  ;Label        ;440  ;5720 ;3300 ;440  ;ParentControl=60 }
    { 82  ;TextBox      ;10230;5610 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Bill-to/Sell-to VAT Calc." }
    { 83  ;Label        ;6820 ;5610 ;3300 ;440  ;ParentControl=82 }
    { 84  ;CheckBox     ;10230;6270 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="Print VAT specification in LCY" }
    { 85  ;Label        ;6820 ;6270 ;3300 ;440  ;ParentControl=84 }
    { 86  ;CheckBox     ;10230;3960 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="Prepayment Unrealized VAT" }
    { 87  ;Label        ;6820 ;3960 ;3300 ;440  ;ParentControl=86 }
    { 1480000;CheckBox  ;10230;6820 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="VAT in Use" }
    { 1480001;Label     ;6820 ;6820 ;3300 ;440  ;ParentControl=1480000 }
    { 10  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Bank Account Nos." }
    { 11  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=10 }
    { 1020000;TextBox   ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Bank Rec. Adj. Doc. Nos." }
    { 1020001;Label     ;440  ;1540 ;3300 ;440  ;ParentControl=1020000 }
    { 1020002;TextBox   ;3850 ;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Deposit Nos." }
    { 1020003;Label     ;440  ;2090 ;3300 ;440  ;ParentControl=1020002 }
    { 22  ;TextBox      ;3850 ;6050 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Shortcut Dimension 8 Code" }
    { 25  ;Label        ;440  ;6050 ;3300 ;440  ;ParentControl=22 }
    { 23  ;TextBox      ;3850 ;5500 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Shortcut Dimension 7 Code" }
    { 24  ;Label        ;440  ;5500 ;3300 ;440  ;ParentControl=23 }
    { 26  ;TextBox      ;3850 ;4950 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Shortcut Dimension 6 Code" }
    { 27  ;Label        ;440  ;4950 ;3300 ;440  ;ParentControl=26 }
    { 28  ;TextBox      ;3850 ;4400 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Shortcut Dimension 5 Code" }
    { 29  ;Label        ;440  ;4400 ;3300 ;440  ;ParentControl=28 }
    { 30  ;TextBox      ;3850 ;3850 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Shortcut Dimension 4 Code" }
    { 31  ;Label        ;440  ;3850 ;3300 ;440  ;ParentControl=30 }
    { 32  ;TextBox      ;3850 ;3300 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Shortcut Dimension 3 Code" }
    { 33  ;Label        ;440  ;3300 ;3300 ;440  ;ParentControl=32 }
    { 34  ;TextBox      ;3850 ;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Shortcut Dimension 2 Code" }
    { 35  ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=34 }
    { 36  ;TextBox      ;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Shortcut Dimension 1 Code" }
    { 37  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=36 }
    { 38  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Global Dimension 2 Code" }
    { 39  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=38 }
    { 40  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Global Dimension 1 Code" }
    { 41  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=40 }
    { 16  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="VAT Exchange Rate Adjustment" }
    { 17  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=16 }
    { 12  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Additional Reporting Currency" }
    { 13  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=12 }
    { 1100768000;TextBox;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Unit-Amount Decimal Places" }
    { 1100768001;Label  ;440  ;2200 ;3300 ;440  ;ParentControl=1100768000 }
    { 1100768002;TextBox;3850 ;3300 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Amount Rounding Precision" }
    { 1100768003;Label  ;440  ;3300 ;3300 ;440  ;ParentControl=1100768002 }
    { 1100768004;TextBox;3850 ;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Amount Decimal Places" }
    { 1100768005;Label  ;440  ;2750 ;3300 ;440  ;ParentControl=1100768004 }
    { 1100768006;TextBox;3850 ;3850 ;2750 ;440  ;ParentControl=1;
                                                 InPage=3;
                                                 SourceExpr="Unit-Amount Decimal Places" }
    { 1100768007;Label  ;440  ;3850 ;3300 ;440  ;ParentControl=1100768006 }
    { 62  ;TextBox      ;3850 ;2750 ;1700 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Payment Discount Grace Period";
                                                 OnValidate=VAR
                                                              PaymentToleranceMgt@1000 : Codeunit 426;
                                                            BEGIN
                                                              IF CONFIRM(Text001,TRUE) THEN
                                                                PaymentToleranceMgt.CalcGracePeriodCVLedgEntry("Payment Discount Grace Period");
                                                            END;
                                                             }
    { 57  ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=62 }
    { 63  ;TextBox      ;3850 ;4400 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Payment Tolerance %" }
    { 58  ;Label        ;440  ;4400 ;3300 ;440  ;ParentControl=63 }
    { 64  ;TextBox      ;3850 ;4950 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Max. Payment Tolerance Amount" }
    { 59  ;Label        ;440  ;4950 ;3300 ;440  ;ParentControl=64 }
    { 65  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Appln. Rounding Precision" }
    { 66  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=65 }
    { 51  ;TextBox      ;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Pmt. Disc. Tolerance Posting" }
    { 61  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=51 }
    { 70  ;TextBox      ;3850 ;3850 ;2750 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Payment Tolerance Posting" }
    { 71  ;Label        ;440  ;3850 ;3300 ;440  ;ParentControl=70 }
    { 72  ;CheckBox     ;3850 ;1650 ;440  ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 ShowCaption=No;
                                                 SourceExpr="Pmt. Disc. Tolerance Warning" }
    { 79  ;Label        ;440  ;1650 ;3300 ;440  ;ParentControl=72 }
    { 80  ;CheckBox     ;3850 ;3300 ;440  ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 ShowCaption=No;
                                                 SourceExpr="Payment Tolerance Warning" }
    { 81  ;Label        ;440  ;3300 ;3300 ;440  ;ParentControl=80 }
    { 1000000000;TextBox;3850 ;5500 ;5500 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Currency Webservice URL" }
    { 1000000001;Label  ;440  ;5500 ;3300 ;440  ;ParentControl=1000000000 }
    { 1000000002;TextBox;3850 ;6050 ;5500 ;440  ;ParentControl=1;
                                                 InPage=4;
                                                 SourceExpr="Currency Webservice Method" }
    { 1000000003;Label  ;440  ;6050 ;3300 ;440  ;ParentControl=1000000002 }
    { 52  ;CommandButton;3740 ;7700 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Default=Yes;
                                                 PushAction=LookupOK;
                                                 InvalidActionAppearance=Hide }
    { 53  ;CommandButton;6160 ;7700 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 Cancel=Yes;
                                                 PushAction=LookupCancel;
                                                 InvalidActionAppearance=Hide }
    { 54  ;CommandButton;11000;7700 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 42  ;MenuButton   ;8580 ;7700 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=F&unctions;
                                                            ESM=Acci&ones;
                                                            FRC=F&onctions;
                                                            ENC=F&unctions];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=44;
                                                     Ellipsis=Yes;
                                                     CaptionML=[ENU=Change Global Dimensions;
                                                                ESM=Cambiar dimen. globales;
                                                                FRC=Modifier dimensions principales;
                                                                ENC=Change Global Dimensions];
                                                     OnPush=BEGIN
                                                              REPORT.RUNMODAL(REPORT::"Change Global Dimensions");
                                                            END;
                                                             }
                                                   { ID=2;
                                                     CaptionML=[ENU=Change Payment &Tolerance;
                                                                ESM=Cambiar &tolerancia pagos;
                                                                FRC=Modifier la &tolÇrance de paiement;
                                                                ENC=Change Payment &Tolerance];
                                                     OnPush=VAR
                                                              ChangePmtTol@1001 : Report 34;
                                                              Currency@1002 : Record 4;
                                                            BEGIN
                                                              Currency.INIT;
                                                              ChangePmtTol.SetCurrency(Currency);
                                                              ChangePmtTol.RUNMODAL;
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=Do you want to change all open entries for every customer and vendor that are not blocked;ESM=®Quiere cambiar todos los movs. pend. de cada cliente y proveedor que no estÇn bloqueados?;FRC=Voulez-vous modifier toutes les entrÇes ouvertes pour les clients et les fournisseurs qui ne sont pas bloquÇs;ENC=Do you want to change all open entries for every customer and vendor that are not blocked';

    BEGIN
    {
      //FP  Add 4 Rounding percision fields on the Reporting tab
    }
    END.
  }
}

OBJECT Form 495 Currency Card
{
  OBJECT-PROPERTIES
  {
    Date=11/07/11;
    Time=10:48:36 AM;
    Modified=Yes;
    Version List=NAVW13.70,NAVNA6.00;
  }
  PROPERTIES
  {
    Width=16280;
    Height=6490;
    CaptionML=[ENU=Currency Card;
               ESM=Ficha divisa;
               FRC=Fiche devise;
               ENC=Currency Card];
    SourceTable=Table4;
    OnAfterGetRecord=BEGIN
                       SETRANGE(Code);
                     END;

  }
  CONTROLS
  {
    { 1   ;TabControl   ;220  ;220  ;15840;5280 ;HorzGlue=Both;
                                                 VertGlue=Both;
                                                 PageNamesML=[ENU=General,Rounding,Reporting;
                                                              ESM=General,Redondeo,Informes;
                                                              FRC=GÇnÇral,Arrondissement,Rapport;
                                                              ENC=General,Rounding,Reporting] }
    { 2   ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Code }
    { 3   ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=2 }
    { 4   ;TextBox      ;3850 ;1540 ;5500 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr=Description }
    { 5   ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=4 }
    { 6   ;TextBox      ;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Unrealized Gains Acc." }
    { 7   ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=6 }
    { 8   ;TextBox      ;3850 ;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Realized Gains Acc." }
    { 9   ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=8 }
    { 10  ;TextBox      ;3850 ;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Unrealized Losses Acc." }
    { 11  ;Label        ;440  ;3410 ;3300 ;440  ;ParentControl=10 }
    { 12  ;TextBox      ;3850 ;3960 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Realized Losses Acc." }
    { 13  ;Label        ;440  ;3960 ;3300 ;440  ;ParentControl=12 }
    { 14  ;TextBox      ;13090;990  ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Last Date Modified" }
    { 15  ;Label        ;9680 ;990  ;3300 ;440  ;ParentControl=14 }
    { 16  ;TextBox      ;13090;1540 ;1650 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Last Date Adjusted" }
    { 17  ;Label        ;9680 ;1540 ;3300 ;440  ;ParentControl=16 }
    { 31  ;CheckBox     ;3850 ;4620 ;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="EMU Currency" }
    { 32  ;Label        ;440  ;4620 ;3300 ;440  ;ParentControl=31 }
    { 44  ;TextBox      ;13090;2090 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Payment Tolerance %" }
    { 45  ;Label        ;9680 ;2090 ;3300 ;440  ;ParentControl=44 }
    { 54  ;TextBox      ;13090;2640 ;2750 ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 SourceExpr="Max. Payment Tolerance Amount" }
    { 55  ;Label        ;9680 ;2640 ;3300 ;440  ;ParentControl=54 }
    { 1000000000;CheckBox;13090;3190;440  ;440  ;ParentControl=1;
                                                 InPage=0;
                                                 ShowCaption=No;
                                                 SourceExpr="Update Exchange Rate" }
    { 1000000001;Label  ;9680 ;3190 ;3300 ;440  ;ParentControl=1000000000 }
    { 18  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Invoice Rounding Precision" }
    { 19  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=18 }
    { 20  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Invoice Rounding Type" }
    { 21  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=20 }
    { 22  ;TextBox      ;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Amount Rounding Precision" }
    { 23  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=22 }
    { 24  ;TextBox      ;3850 ;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Amount Decimal Places" }
    { 25  ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=24 }
    { 26  ;TextBox      ;3850 ;3960 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Unit-Amount Decimal Places" }
    { 27  ;Label        ;440  ;3960 ;3300 ;440  ;ParentControl=26 }
    { 41  ;TextBox      ;3850 ;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Unit-Amount Rounding Precision" }
    { 42  ;Label        ;440  ;3410 ;3300 ;440  ;ParentControl=41 }
    { 29  ;TextBox      ;3850 ;4620 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Appln. Rounding Precision" }
    { 30  ;Label        ;440  ;4620 ;3300 ;440  ;ParentControl=29 }
    { 46  ;TextBox      ;13090;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Conv. LCY Rndg. Debit Acc." }
    { 47  ;Label        ;9680 ;990  ;3300 ;440  ;ParentControl=46 }
    { 48  ;TextBox      ;13090;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Conv. LCY Rndg. Credit Acc." }
    { 49  ;Label        ;9680 ;1540 ;3300 ;440  ;ParentControl=48 }
    { 50  ;TextBox      ;13090;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="Max. VAT Difference Allowed" }
    { 51  ;Label        ;9680 ;2200 ;3300 ;440  ;ParentControl=50 }
    { 52  ;TextBox      ;13090;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=1;
                                                 SourceExpr="VAT Rounding Type" }
    { 53  ;Label        ;9680 ;2750 ;3300 ;440  ;ParentControl=52 }
    { 33  ;TextBox      ;3850 ;990  ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Realized G/L Gains Account" }
    { 34  ;Label        ;440  ;990  ;3300 ;440  ;ParentControl=33 }
    { 35  ;TextBox      ;3850 ;1540 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Realized G/L Losses Account" }
    { 36  ;Label        ;440  ;1540 ;3300 ;440  ;ParentControl=35 }
    { 37  ;TextBox      ;3850 ;2200 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Residual Gains Account" }
    { 38  ;Label        ;440  ;2200 ;3300 ;440  ;ParentControl=37 }
    { 40  ;TextBox      ;3850 ;2750 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr="Residual Losses Account" }
    { 43  ;Label        ;440  ;2750 ;3300 ;440  ;ParentControl=40 }
    { 1400000;TextBox   ;3850 ;3410 ;2750 ;440  ;ParentControl=1;
                                                 InPage=2;
                                                 SourceExpr=Symbol }
    { 1400001;Label     ;440  ;3410 ;3300 ;440  ;ParentControl=1400000 }
    { 28  ;CommandButton;13860;5720 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=FormHelp }
    { 39  ;CommandButton;11440;5720 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 PushAction=RunObject;
                                                 CaptionML=[ENU=Exch. &Rates;
                                                            ESM=Tipo &cambio;
                                                            FRC=&Taux de change;
                                                            ENC=Exch. &Rates];
                                                 RunObject=Form 483;
                                                 RunFormLinkType=OnUpdate;
                                                 RunFormLink=Currency Code=FIELD(Code) }
    { 56  ;MenuButton   ;9020 ;5720 ;2200 ;550  ;HorzGlue=Right;
                                                 VertGlue=Bottom;
                                                 CaptionML=[ENU=F&unctions;
                                                            ESM=Acci&ones;
                                                            FRC=F&onctions;
                                                            ENC=F&unctions];
                                                 Menu=MENUITEMS
                                                 {
                                                   { ID=58;
                                                     CaptionML=[ENU=Change Payment &Tolerance;
                                                                ESM=Cambiar &tolerancia pagos;
                                                                FRC=Modifier la &tolÇrance de paiement;
                                                                ENC=Change Payment &Tolerance];
                                                     OnPush=VAR
                                                              ChangePmtTol@1001 : Report 34;
                                                            BEGIN
                                                              ChangePmtTol.SetCurrency(Rec);
                                                              ChangePmtTol.RUNMODAL;
                                                            END;
                                                             }
                                                   { ID=1000000002;
                                                     CaptionML=ENU=Update Exchange Rate;
                                                     OnPush=VAR
                                                              CurrencyWebService@1000000000 : Codeunit 50010;
                                                            BEGIN
                                                              // WMI0001 >>
                                                              CurrencyWebService.UpdateExchangeRate(Rec);
                                                              // WMI0001 <<
                                                            END;
                                                             }
                                                 }
                                                  }
  }
  CODE
  {

    BEGIN
    {
      WMI0001 SK  11/07/11: Added field and menu item "Update Exchange Rate".
    }
    END.
  }
}

OBJECT Codeunit 50010 Currency WebService
{
  OBJECT-PROPERTIES
  {
    Date=11/07/11;
    Time=11:05:03 AM;
    Modified=Yes;
    Version List=SK;
  }
  PROPERTIES
  {
    TableNo=99008535;
    OnRun=VAR
            XmlHttp@1000000003 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 5.0:{F6D90F16-9C73-11D3-B32E-00C04F990BB4}:'Microsoft XML, v5.0'.XMLHTTP";
            XmlDoc@1000000002 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 5.0:{F6D90F11-9C73-11D3-B32E-00C04F990BB4}:'Microsoft XML, v5.0'.DOMDocument";
            XmlNode@1000000001 : Automation "{F5078F18-C551-11D3-89B9-0000F81FE221} 3.0:{2933BF80-7B36-11D2-B20E-00C04F983E60}:'Microsoft XML, v3.0'.IXMLDOMNode";
            TempInstream@1000000000 : InStream;
          BEGIN
            GLSetup.GET;
            GLSetup.TESTFIELD("Currency Webservice URL");
            IF ISCLEAR(XmlDoc) THEN
              CREATE(XmlDoc);

            IF ISCLEAR(XmlHttp) THEN
              CREATE(XmlHttp);

            Blob.CREATEINSTREAM(TempInstream);

            XmlDoc.async := FALSE;
            XmlDoc.load(TempInstream);

            //XmlDoc.save('C:\xmlport.xml'); //uncomment if you want to see the xml file
            //HYPERLINK('C:\xmlport.xml');

            XmlHttp.open('POST',GLSetup."Currency Webservice URL",0);
            XmlHttp.setRequestHeader('Content-type','text/xml');
            XmlHttp.setRequestHeader('SOAPAction',GLSetup."Currency Webservice Method");
            XmlHttp.send(XmlDoc);

            XmlDoc.load(XmlHttp.responseXML);

            IF XmlHttp.readyState <> 4 THEN
              ERROR(Text005);
            IF XmlHttp.status <> 200 THEN
              ERROR(Text004 + ' ' + FORMAT(XmlHttp.status) + ': ' + XmlHttp.statusText);

            //XmlDoc.save('C:\response.xml');  ///uncomment if you want to see the xml file
            //HYPERLINK('C:\response.xml');
            ConversionRateResult := 0;
            XmlNode := XmlDoc.selectSingleNode(Xml001);
            IF NOT ISCLEAR(XmlNode) THEN BEGIN
              IF EVALUATE(ConversionRateResult,XmlNode.text) THEN;
            END;

            //SLEEP(1000);
            CLEAR(XmlDoc);
            CLEAR(XmlHttp)
          END;

  }
  CODE
  {
    VAR
      ConversionRateResult@1000000000 : Decimal;
      GLSetup@1000000001 : Record 98;
      Text001@1000000002 : TextConst 'ENU=The following Currencies could not be updated\';
      Text002@1000000003 : TextConst 'ENU=Please Check currency codes http://www.webservicex.net/CurrencyConvertor.asmx?ConversionRate';
      Text003@1000000004 : TextConst 'ENU=Cannot be blank. Please Enter 3 Letter Local Currency Code';
      Text004@1000000005 : TextConst 'ENU=Http Error';
      Text005@1000000006 : TextConst 'ENU=XmlHttp Not Ready';
      Xml001@1000000007 : TextConst 'ENU=soap:Envelope/soap:Body/ConversionRateResponse/ConversionRateResult';

    PROCEDURE UpdateExchangeRates@1000000002();
    VAR
      GLSetup@1000000000 : Record 98;
      Currency@1000000001 : Record 4;
      TempCurrency@1000000002 : TEMPORARY Record 4;
      CurrencyExchangeRate@1000000003 : Record 330;
      Rate@1000000004 : Decimal;
      Successfull@1000000005 : Boolean;
    BEGIN
      GLSetup.GET;
      IF GLSetup."LCY Code" = '' THEN
        GLSetup.FIELDERROR("LCY Code",Text003);
      Currency.RESET;
      Currency.SETRANGE("Update Exchange Rate",TRUE);
      IF Currency.FINDSET THEN REPEAT
        Rate := GenerateXMLandRate(GLSetup."LCY Code",Currency.Code,Successfull);
        IF Successfull AND (Rate <> 0) THEN BEGIN
          IF NOT CurrencyExchangeRate.GET(Currency.Code,TODAY) THEN BEGIN
            CLEAR(CurrencyExchangeRate);
            CurrencyExchangeRate.VALIDATE("Currency Code",Currency.Code);
            CurrencyExchangeRate.VALIDATE("Starting Date",TODAY);
            CurrencyExchangeRate.INSERT(TRUE);
          END;

          CurrencyExchangeRate.VALIDATE("Currency Code",Currency.Code);
          CurrencyExchangeRate.VALIDATE("Starting Date",TODAY);
          CurrencyExchangeRate.VALIDATE("Exchange Rate Amount",Rate);
          CurrencyExchangeRate.VALIDATE("Adjustment Exch. Rate Amount",Rate);
          CurrencyExchangeRate.VALIDATE("Relational Exch. Rate Amount",1);
          CurrencyExchangeRate.VALIDATE("Fix Exchange Rate Amount",CurrencyExchangeRate."Fix Exchange Rate Amount"::Currency);
          CurrencyExchangeRate.VALIDATE("Relational Adjmt Exch Rate Amt",1);
          CurrencyExchangeRate.MODIFY(TRUE);
          COMMIT;
        END ELSE BEGIN
          TempCurrency.Code := Currency.Code;
          TempCurrency.INSERT;
        END;
      UNTIL Currency.NEXT = 0;

      IF TempCurrency.COUNT <> 0 THEN BEGIN
        IF GUIALLOWED THEN BEGIN
          MESSAGE(Text001 +
                  Text002);
          FORM.RUN(0,TempCurrency);
        END;
      END;
    END;

    PROCEDURE GetConversionRate@1000000000() : Decimal;
    BEGIN
      EXIT(ConversionRateResult);
    END;

    LOCAL PROCEDURE GenerateXMLandRate@1000000009(FromCurrency@1000000004 : Code[10];ToCurrency@1000000005 : Code[10];VAR Success@1000000006 : Boolean) : Decimal;
    VAR
      TempBlob@1000000001 : TEMPORARY Record 99008535;
      Ostream@1000000000 : OutStream;
      MyXmlPort@1000000002 : XMLport 50002;
      CurrencyWebservice@1000000003 : Codeunit 50010;
    BEGIN

      CLEAR(TempBlob);
      TempBlob.Blob.CREATEOUTSTREAM(Ostream);
      MyXmlPort.SetCurrencyCodes(FromCurrency,ToCurrency);
      MyXmlPort.SETDESTINATION(Ostream);
      MyXmlPort.EXPORT;
      CLEAR(CurrencyWebservice);

      Success := CurrencyWebservice.RUN(TempBlob);
      //Success := TRUE;
      IF Success THEN
        EXIT(CurrencyWebservice.GetConversionRate)
      ELSE
        EXIT(0);
    END;

    PROCEDURE UpdateExchangeRate@1000000004(VAR Currency@1000000006 : Record 4);
    VAR
      GLSetup@1000000000 : Record 98;
      TempCurrency@1000000002 : TEMPORARY Record 4;
      CurrencyExchangeRate@1000000003 : Record 330;
      Rate@1000000004 : Decimal;
      Successfull@1000000005 : Boolean;
    BEGIN
      GLSetup.GET;
      IF GLSetup."LCY Code" = '' THEN
        GLSetup.FIELDERROR("LCY Code",Text003);
      Currency.TESTFIELD("Update Exchange Rate");
      Rate := GenerateXMLandRate(GLSetup."LCY Code",Currency.Code,Successfull);
      IF Successfull AND (Rate <> 0) THEN BEGIN
        IF NOT CurrencyExchangeRate.GET(Currency.Code,TODAY) THEN BEGIN
          CLEAR(CurrencyExchangeRate);
          CurrencyExchangeRate.VALIDATE("Currency Code",Currency.Code);
          CurrencyExchangeRate.VALIDATE("Starting Date",TODAY);
          CurrencyExchangeRate.INSERT(TRUE);
        END;

        CurrencyExchangeRate.VALIDATE("Currency Code",Currency.Code);
        CurrencyExchangeRate.VALIDATE("Starting Date",TODAY);
        CurrencyExchangeRate.VALIDATE("Exchange Rate Amount",Rate);
        CurrencyExchangeRate.VALIDATE("Adjustment Exch. Rate Amount",Rate);
        CurrencyExchangeRate.VALIDATE("Relational Exch. Rate Amount",1);
        CurrencyExchangeRate.VALIDATE("Fix Exchange Rate Amount",CurrencyExchangeRate."Fix Exchange Rate Amount"::Currency);
        CurrencyExchangeRate.VALIDATE("Relational Adjmt Exch Rate Amt",1);
        CurrencyExchangeRate.MODIFY(TRUE);
        COMMIT;
      END ELSE BEGIN
        TempCurrency.Code := Currency.Code;
        TempCurrency.INSERT;
      END;

      IF TempCurrency.COUNT <> 0 THEN BEGIN
        IF GUIALLOWED THEN BEGIN
          MESSAGE(Text001 + Text002);
          FORM.RUN(0,TempCurrency);
        END;
      END;
    END;

    BEGIN
    {
      WMI0001 SK  11/05/11: Created new codeunit.
    }
    END.
  }
}

OBJECT XMLport 50002 XML Currency Exchange
{
  OBJECT-PROPERTIES
  {
    Date=11/07/11;
    Time=10:32:24 AM;
    Modified=Yes;
    Version List=;
  }
  PROPERTIES
  {
    OnInitXMLport=BEGIN
                    xmlnsSoapenv := 'http://schemas.xmlsoap.org/soap/envelope/';
                    xmlnsWeb := 'http://www.webserviceX.NET/';
                    FromCurrency := 'USD';
                    ToCurrency := 'EUR';
                  END;

    OnPreXMLport=BEGIN
                   IF (FromCurrency = '') OR (ToCurrency = '') THEN
                     ERROR('Please set currency codes first');
                 END;

  }
  ELEMENTS
  {
    { [{375EFE96-EDD8-4598-9269-141E48BE3650}];  ;soapenv:Envelope    ;Element ;Text     }

    { [{571C3E3F-9F7F-432C-B771-DB0817F0553F}];1 ;xmlns:soapenv       ;Attribute;Text   ;
                                                  VariableName=xmlnsSoapenv }

    { [{D0FF1893-D99E-4EEC-8137-16E49C496160}];1 ;xmlns:web           ;Attribute;Text   ;
                                                  VariableName=xmlnsWeb }

    { [{E013F4C7-4DAF-4B9A-A35C-1D62511BE730}];1 ;soapenv:Header      ;Element ;Text     }

    { [{B7EB8F33-9C41-4E24-B7FE-F5635B0C8D62}];1 ;soapenv:Body        ;Element ;Text     }

    { [{13375059-BFF8-43AB-A523-7B7C215AA4EB}];2 ;web:ConversionRate  ;Element ;Text     }

    { [{6358A5A6-0ADE-4B58-AE5F-0B79C6F414CF}];3 ;web:FromCurrency    ;Element ;Text    ;
                                                  VariableName=FromCurrency }

    { [{0C05CF74-B501-496C-BF13-47A0740F12F6}];3 ;web:ToCurrency      ;Element ;Text    ;
                                                  VariableName=ToCurrency }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {

    PROCEDURE SetCurrencyCodes@1000000000(LFromCurrency@1000000000 : Code[10];LToCurrency@1000000001 : Code[10]);
    BEGIN
      FromCurrency := LFromCurrency;
      ToCurrency := LToCurrency;
    END;

    BEGIN
    {
      WMI0001 SK  11/05/11: Created new xmlport.
    }
    END.
  }
}

OBJECT Page 5 Currencies
{
  OBJECT-PROPERTIES
  {
    Date=11/07/11;
    Time=11:08:52 AM;
    Modified=Yes;
    Version List=NAVW14.00.01,NAVNA5.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Currencies;
               ESM=Divisas;
               FRC=Devises;
               ENC=Currencies];
    SourceTable=Table4;
    PageType=List;
    CardFormID=Page495;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 60      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 ESM=Acci&ones;
                                 FRC=F&onctions;
                                 ENC=F&unctions] }
      { 61      ;2   ;Action    ;
                      CaptionML=[ENU=Change Payment &Tolerance;
                                 ESM=Cambiar &tolerancia pagos;
                                 FRC=Modifier la &tolÇrance de paiement;
                                 ENC=Change Payment &Tolerance];
                      Promoted=Yes;
                      Image=ChangePaymentTolerance;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ChangePmtTol@1001 : Report 34;
                               BEGIN
                                 ChangePmtTol.SetCurrency(Rec);
                                 ChangePmtTol.RUNMODAL;
                               END;
                                }
      { 1000000001;2 ;Action    ;
                      CaptionML=ENU=Update Exchange Rates;
                      Promoted=Yes;
                      Image=AdjustExchangeRates;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CurrencyWebService@1000000000 : Codeunit 50010;
                               BEGIN
                                 // WMI0001 >>
                                 CurrencyWebService.UpdateExchangeRates;
                                 // WMI0001 <<
                               END;
                                }
      { 4       ;1   ;Action    ;
                      CaptionML=[ENU=Exch. &Rates;
                                 ESM=Tipo &cambio;
                                 FRC=&Taux de change;
                                 ENC=Exch. &Rates];
                      RunObject=Page 483;
                      RunFormLink=Currency Code=FIELD(Code);
                      Promoted=Yes;
                      Image=CurrencyExchangeRates;
                      PromotedCategory=Process }
      { 1904035104;1 ;Action    ;
                      CaptionML=[ENU=Adjust Exchange Rate;
                                 ESM=Ajustar tipo cambio;
                                 FRC=Ajuster taux de change;
                                 ENC=Adjust Exchange Rate];
                      RunObject=Report 595;
                      Promoted=Yes;
                      Image=AdjustExchangeRates;
                      PromotedCategory=Process }
      { 1900169904;1 ;Action    ;
                      CaptionML=[ENU=Exchange Rate Adjust. Register;
                                 ESM=Registro ajuste tipo cambio;
                                 FRC=Historique des transactions d'ajust. taux de change;
                                 ENC=Exchange Rate Adjust. Register];
                      RunObject=Page 106;
                      RunFormLink=Currency Code=FIELD(Code);
                      Promoted=Yes;
                      Image=ExchangeRateAdjustRegister;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1901143306;1 ;Action    ;
                      CaptionML=[ENU=Foreign Currency Balance;
                                 ESM=Saldo divisas extranjeras;
                                 FRC=Solde en devises;
                                 ENC=Foreign Currency Balance];
                      RunObject=Report 503;
                      Promoted=No;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Code }

    { 29  ;2   ;Field     ;
                SourceExpr=Description }

    { 1480000;2;Field     ;
                SourceExpr=Symbol }

    { 44  ;2   ;Field     ;
                SourceExpr="EMU Currency" }

    { 6   ;2   ;Field     ;
                SourceExpr="Realized Gains Acc." }

    { 21  ;2   ;Field     ;
                SourceExpr="Realized Losses Acc." }

    { 8   ;2   ;Field     ;
                SourceExpr="Unrealized Gains Acc." }

    { 19  ;2   ;Field     ;
                SourceExpr="Unrealized Losses Acc." }

    { 5   ;2   ;Field     ;
                SourceExpr="Realized G/L Gains Account";
                Visible=FALSE }

    { 18  ;2   ;Field     ;
                SourceExpr="Realized G/L Losses Account";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Residual Gains Account";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Residual Losses Account";
                Visible=FALSE }

    { 25  ;2   ;Field     ;
                SourceExpr="Amount Rounding Precision" }

    { 36  ;2   ;Field     ;
                SourceExpr="Amount Decimal Places" }

    { 23  ;2   ;Field     ;
                SourceExpr="Invoice Rounding Precision" }

    { 27  ;2   ;Field     ;
                SourceExpr="Invoice Rounding Type" }

    { 31  ;2   ;Field     ;
                SourceExpr="Unit-Amount Rounding Precision" }

    { 38  ;2   ;Field     ;
                SourceExpr="Unit-Amount Decimal Places" }

    { 42  ;2   ;Field     ;
                SourceExpr="Appln. Rounding Precision" }

    { 50  ;2   ;Field     ;
                SourceExpr="Conv. LCY Rndg. Debit Acc." }

    { 52  ;2   ;Field     ;
                SourceExpr="Conv. LCY Rndg. Credit Acc." }

    { 54  ;2   ;Field     ;
                SourceExpr="Max. VAT Difference Allowed";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="VAT Rounding Type";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Last Date Adjusted" }

    { 12  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 34  ;2   ;Field     ;
                SourceExpr="Payment Tolerance %" }

    { 1000000000;2;Field  ;
                SourceExpr="Update Exchange Rate" }

    { 58  ;2   ;Field     ;
                SourceExpr="Max. Payment Tolerance Amount" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    PROCEDURE GetSelectionFilter@2() : Code[80];
    VAR
      Currency@1000 : Record 4;
      FirstCurrency@1001 : Code[30];
      LastCurrency@1002 : Code[30];
      SelectionFilter@1003 : Code[250];
      CurrencyCount@1004 : Integer;
      More@1005 : Boolean;
    BEGIN
      CurrPage.SETSELECTIONFILTER(Currency);
      CurrencyCount := Currency.COUNT;
      IF CurrencyCount > 0 THEN BEGIN
        Currency.FIND('-');
        WHILE CurrencyCount > 0 DO BEGIN
          CurrencyCount := CurrencyCount - 1;
          Currency.MARKEDONLY(FALSE);
          FirstCurrency := Currency.Code;
          LastCurrency := FirstCurrency;
          More := (CurrencyCount > 0);
          WHILE More DO
            IF Currency.NEXT = 0 THEN
              More := FALSE
            ELSE
              IF NOT Currency.MARK THEN
                More := FALSE
              ELSE BEGIN
                LastCurrency := Currency.Code;
                CurrencyCount := CurrencyCount - 1;
                IF CurrencyCount = 0 THEN
                  More := FALSE;
              END;
          IF SelectionFilter <> '' THEN
            SelectionFilter := SelectionFilter + '|';
          IF FirstCurrency = LastCurrency THEN
            SelectionFilter := SelectionFilter + FirstCurrency
          ELSE
            SelectionFilter := SelectionFilter + FirstCurrency + '..' + LastCurrency;
          IF CurrencyCount > 0 THEN BEGIN
            Currency.MARKEDONLY(TRUE);
            Currency.NEXT;
          END;
        END;
      END;
      EXIT(SelectionFilter);
    END;

    PROCEDURE GetCurrency@1(VAR "Currency Code"@1000 : Code[10]);
    BEGIN
      "Currency Code" := Rec.Code;
    END;

    BEGIN
    {
      WMI0001 SK  11/07/11: Added field "Update Exchange Rate".
    }
    END.
  }
}

OBJECT Page 118 General Ledger Setup
{
  OBJECT-PROPERTIES
  {
    Date=11/07/11;
    Time=11:05:30 AM;
    Modified=Yes;
    Version List=NAVW15.00.01,NAVUS3.70,FP;
  }
  PROPERTIES
  {
    CaptionML=[ENU=General Ledger Setup;
               ESM=Configuraci¢n contabilidad;
               FRC=Configuration du grand livre;
               ENC=General Ledger Setup];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table98;
    PageType=Card;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 42      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 ESM=Acci&ones;
                                 FRC=F&onctions;
                                 ENC=F&unctions] }
      { 44      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Change Global Dimensions;
                                 ESM=Cambiar dimen. globales;
                                 FRC=Modifier dimensions principales;
                                 ENC=Change Global Dimensions];
                      OnAction=BEGIN
                                 REPORT.RUNMODAL(REPORT::"Change Global Dimensions");
                               END;
                                }
      { 2       ;2   ;Action    ;
                      CaptionML=[ENU=Change Payment &Tolerance;
                                 ESM=Cambiar &tolerancia pagos;
                                 FRC=Modifier la &tolÇrance de paiement;
                                 ENC=Change Payment &Tolerance];
                      Image=ChangePaymentTolerance;
                      OnAction=VAR
                                 ChangePmtTol@1001 : Report 34;
                                 Currency@1002 : Record 4;
                               BEGIN
                                 Currency.INIT;
                                 ChangePmtTol.SetCurrency(Currency);
                                 ChangePmtTol.RUNMODAL;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           ESM=General;
                           FRC=GÇnÇral;
                           ENC=General] }

    { 6   ;2   ;Field     ;
                SourceExpr="Allow Posting From" }

    { 8   ;2   ;Field     ;
                SourceExpr="Allow Posting To" }

    { 43  ;2   ;Field     ;
                SourceExpr="Register Time" }

    { 67  ;2   ;Field     ;
                SourceExpr="Local Address Format" }

    { 73  ;2   ;Field     ;
                SourceExpr="Local Cont. Addr. Format" }

    { 77  ;2   ;Field     ;
                SourceExpr="Inv. Rounding Precision (LCY)" }

    { 75  ;2   ;Field     ;
                SourceExpr="Inv. Rounding Type (LCY)" }

    { 55  ;2   ;Field     ;
                SourceExpr="Allow G/L Acc. Deletion Before" }

    { 60  ;2   ;Field     ;
                SourceExpr="Check G/L Account Usage" }

    { 14  ;2   ;Field     ;
                SourceExpr="EMU Currency" }

    { 18  ;2   ;Field     ;
                SourceExpr="LCY Code" }

    { 49  ;2   ;Field     ;
                SourceExpr="Pmt. Disc. Excl. VAT" }

    { 47  ;2   ;Field     ;
                SourceExpr="Adjust for Payment Disc." }

    { 21  ;2   ;Field     ;
                SourceExpr="Unrealized VAT" }

    { 86  ;2   ;Field     ;
                SourceExpr="Prepayment Unrealized VAT" }

    { 5   ;2   ;Field     ;
                SourceExpr="Max. VAT Difference Allowed" }

    { 3   ;2   ;Field     ;
                SourceExpr="VAT Rounding Type" }

    { 82  ;2   ;Field     ;
                SourceExpr="Bill-to/Sell-to VAT Calc." }

    { 84  ;2   ;Field     ;
                SourceExpr="Print VAT specification in LCY" }

    { 1480000;2;Field     ;
                SourceExpr="VAT in Use" }

    { 1904569201;1;Group  ;
                CaptionML=[ENU=Numbering;
                           ESM=Numeraci¢n;
                           FRC=NumÇrotage;
                           ENC=Numbering] }

    { 10  ;2   ;Field     ;
                SourceExpr="Bank Account Nos." }

    { 1020000;2;Field     ;
                SourceExpr="Bank Rec. Adj. Doc. Nos." }

    { 1020002;2;Field     ;
                SourceExpr="Deposit Nos." }

    { 1900309501;1;Group  ;
                CaptionML=[ENU=Dimensions;
                           ESM=Dimensiones;
                           FRC=Dimensions;
                           ENC=Dimensions] }

    { 40  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code" }

    { 38  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code" }

    { 36  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 1 Code" }

    { 34  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 2 Code" }

    { 32  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 3 Code" }

    { 30  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 4 Code" }

    { 28  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 5 Code" }

    { 26  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 6 Code" }

    { 23  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 7 Code" }

    { 22  ;2   ;Field     ;
                SourceExpr="Shortcut Dimension 8 Code" }

    { 1904488501;1;Group  ;
                CaptionML=[ENU=Reporting;
                           ESM=Notificaci¢n;
                           FRC=Rapport;
                           ENC=Reporting] }

    { 12  ;2   ;Field     ;
                SourceExpr="Additional Reporting Currency" }

    { 16  ;2   ;Field     ;
                SourceExpr="VAT Exchange Rate Adjustment" }

    { 1100768000;2;Field  ;
                SourceExpr="Unit-Amount Decimal Places" }

    { 1100768004;2;Field  ;
                SourceExpr="Amount Decimal Places" }

    { 1100768002;2;Field  ;
                SourceExpr="Amount Rounding Precision" }

    { 1100768006;2;Field  ;
                SourceExpr="Unit-Amount Decimal Places" }

    { 1904409301;1;Group  ;
                CaptionML=[ENU=Application;
                           ESM=Liquidaci¢n;
                           FRC=Affectation;
                           ENC=Application] }

    { 65  ;2   ;Field     ;
                SourceExpr="Appln. Rounding Precision" }

    { 72  ;2   ;Field     ;
                SourceExpr="Pmt. Disc. Tolerance Warning" }

    { 51  ;2   ;Field     ;
                SourceExpr="Pmt. Disc. Tolerance Posting" }

    { 62  ;2   ;Field     ;
                SourceExpr="Payment Discount Grace Period";
                OnValidate=VAR
                             PaymentToleranceMgt@1000 : Codeunit 426;
                           BEGIN
                             IF CONFIRM(Text001,TRUE) THEN
                               PaymentToleranceMgt.CalcGracePeriodCVLedgEntry("Payment Discount Grace Period");
                           END;
                            }

    { 80  ;2   ;Field     ;
                SourceExpr="Payment Tolerance Warning" }

    { 70  ;2   ;Field     ;
                SourceExpr="Payment Tolerance Posting" }

    { 63  ;2   ;Field     ;
                SourceExpr="Payment Tolerance %" }

    { 64  ;2   ;Field     ;
                SourceExpr="Max. Payment Tolerance Amount" }

    { 1000000000;2;Field  ;
                SourceExpr="Currency Webservice URL" }

    { 1000000001;2;Field  ;
                SourceExpr="Currency Webservice Method" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=Do you want to change all open entries for every customer and vendor that are not blocked;ESM=®Quiere cambiar todos los movs. pend. de cada cliente y proveedor que no estÇn bloqueados?;FRC=Voulez-vous modifier toutes les entrÇes ouvertes pour les clients et les fournisseurs qui ne sont pas bloquÇs;ENC=Do you want to change all open entries for every customer and vendor that are not blocked';

    BEGIN
    {
      //FP  Add 4 Rounding percision fields on the Reporting tab
      WMI0001 SK  11/07/11: Added new field Currency Webservice URL.
    }
    END.
  }
}

OBJECT Page 495 Currency Card
{
  OBJECT-PROPERTIES
  {
    Date=11/07/11;
    Time=11:09:37 AM;
    Modified=Yes;
    Version List=NAVW13.70,NAVNA6.00;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Currency Card;
               ESM=Ficha divisa;
               FRC=Fiche devise;
               ENC=Currency Card];
    SourceTable=Table4;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 56      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 ESM=Acci&ones;
                                 FRC=F&onctions;
                                 ENC=F&unctions] }
      { 58      ;2   ;Action    ;
                      CaptionML=[ENU=Change Payment &Tolerance;
                                 ESM=Cambiar &tolerancia pagos;
                                 FRC=Modifier la &tolÇrance de paiement;
                                 ENC=Change Payment &Tolerance];
                      Promoted=Yes;
                      Image=ChangePaymentTolerance;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ChangePmtTol@1001 : Report 34;
                               BEGIN
                                 ChangePmtTol.SetCurrency(Rec);
                                 ChangePmtTol.RUNMODAL;
                               END;
                                }
      { 1000000002;2 ;Action    ;
                      Name=<Action1000000001>;
                      CaptionML=ENU=Update Exchange Rate;
                      Promoted=Yes;
                      Image=AdjustExchangeRates;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CurrencyWebService@1000000000 : Codeunit 50010;
                               BEGIN
                                 // WMI0001 >>
                                 CurrencyWebService.UpdateExchangeRate(Rec);
                                 // WMI0001 <<
                               END;
                                }
      { 39      ;1   ;Action    ;
                      CaptionML=[ENU=Exch. &Rates;
                                 ESM=Tipo &cambio;
                                 FRC=&Taux de change;
                                 ENC=Exch. &Rates];
                      RunObject=Page 483;
                      RunFormLink=Currency Code=FIELD(Code);
                      Promoted=Yes;
                      Image=CurrencyExchangeRates;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1901143306;1 ;Action    ;
                      CaptionML=[ENU=Foreign Currency Balance;
                                 ESM=Saldo divisas extranjeras;
                                 FRC=Solde en devises;
                                 ENC=Foreign Currency Balance];
                      RunObject=Report 503;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1900711606;1 ;Action    ;
                      CaptionML=[ENU=Aged Accounts Receivable;
                                 ESM=AntigÅedad cobros;
                                 FRC=Comptes clients classÇs chronologiquement;
                                 ENC=Aged Accounts Receivable];
                      RunObject=Report 10040;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1905388206;1 ;Action    ;
                      CaptionML=[ENU=Aged Accounts Payable;
                                 ESM=AntigÅedad pagos;
                                 FRC=Comptes fournisseurs classÇs chronologiquement;
                                 ENC=Aged Accounts Payable];
                      RunObject=Report 10085;
                      Promoted=Yes;
                      PromotedCategory=Report }
      { 1904082706;1 ;Action    ;
                      CaptionML=[ENU=Trial Balance;
                                 ESM=Balance comprobaci¢n;
                                 FRC=Balance de vÇrification;
                                 ENC=Trial Balance];
                      RunObject=Report 10022;
                      Promoted=Yes;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           ESM=General;
                           FRC=GÇnÇral;
                           ENC=General] }

    { 2   ;2   ;Field     ;
                SourceExpr=Code;
                Importance=Promoted }

    { 4   ;2   ;Field     ;
                SourceExpr=Description;
                Importance=Promoted }

    { 6   ;2   ;Field     ;
                SourceExpr="Unrealized Gains Acc." }

    { 8   ;2   ;Field     ;
                SourceExpr="Realized Gains Acc." }

    { 10  ;2   ;Field     ;
                SourceExpr="Unrealized Losses Acc." }

    { 12  ;2   ;Field     ;
                SourceExpr="Realized Losses Acc." }

    { 31  ;2   ;Field     ;
                SourceExpr="EMU Currency";
                Importance=Promoted }

    { 14  ;2   ;Field     ;
                SourceExpr="Last Date Modified" }

    { 16  ;2   ;Field     ;
                SourceExpr="Last Date Adjusted";
                Importance=Promoted }

    { 44  ;2   ;Field     ;
                SourceExpr="Payment Tolerance %" }

    { 54  ;2   ;Field     ;
                SourceExpr="Max. Payment Tolerance Amount" }

    { 1000000000;2;Field  ;
                SourceExpr="Update Exchange Rate" }

    { 1907140501;1;Group  ;
                CaptionML=[ENU=Rounding;
                           ESM=Redondeo;
                           FRC=Arrondissement;
                           ENC=Rounding] }

    { 18  ;2   ;Field     ;
                SourceExpr="Invoice Rounding Precision";
                Importance=Promoted }

    { 20  ;2   ;Field     ;
                SourceExpr="Invoice Rounding Type";
                Importance=Promoted }

    { 22  ;2   ;Field     ;
                SourceExpr="Amount Rounding Precision" }

    { 24  ;2   ;Field     ;
                SourceExpr="Amount Decimal Places" }

    { 41  ;2   ;Field     ;
                SourceExpr="Unit-Amount Rounding Precision" }

    { 26  ;2   ;Field     ;
                SourceExpr="Unit-Amount Decimal Places" }

    { 29  ;2   ;Field     ;
                SourceExpr="Appln. Rounding Precision" }

    { 46  ;2   ;Field     ;
                SourceExpr="Conv. LCY Rndg. Debit Acc." }

    { 48  ;2   ;Field     ;
                SourceExpr="Conv. LCY Rndg. Credit Acc." }

    { 50  ;2   ;Field     ;
                SourceExpr="Max. VAT Difference Allowed";
                Importance=Promoted }

    { 52  ;2   ;Field     ;
                SourceExpr="VAT Rounding Type";
                Importance=Promoted }

    { 1904488501;1;Group  ;
                CaptionML=[ENU=Reporting;
                           ESM=Notificaci¢n;
                           FRC=Rapport;
                           ENC=Reporting] }

    { 33  ;2   ;Field     ;
                SourceExpr="Realized G/L Gains Account";
                Importance=Promoted }

    { 35  ;2   ;Field     ;
                SourceExpr="Realized G/L Losses Account";
                Importance=Promoted }

    { 37  ;2   ;Field     ;
                SourceExpr="Residual Gains Account";
                Importance=Promoted }

    { 40  ;2   ;Field     ;
                SourceExpr="Residual Losses Account";
                Importance=Promoted }

    { 1400000;2;Field     ;
                SourceExpr=Symbol }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

